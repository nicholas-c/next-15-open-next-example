"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"MultiFileWriter",{enumerable:!0,get:function(){return MultiFileWriter}});const _path=_interop_require_default(require("../shared/lib/isomorphic/path"));function _interop_require_default(t){return t&&t.__esModule?t:{default:t}}class MultiFileWriter{constructor(t){this.fs=t,this.tasks=[]}findOrCreateTask(t){for(const e of this.tasks)if(e[0]===t)return e;const e=this.fs.mkdir(t);e.catch((()=>{}));const r=[t,e,[]];return this.tasks.push(r),r}append(t,e){const r=this.findOrCreateTask(_path.default.dirname(t)),s=r[1].then((()=>this.fs.writeFile(t,e)));s.catch((()=>{})),r[2].push(s)}wait(){return Promise.all(this.tasks.flatMap((t=>t[2])))}}