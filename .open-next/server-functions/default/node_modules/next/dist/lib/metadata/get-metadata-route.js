"use strict";function _export(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}Object.defineProperty(exports,"__esModule",{value:!0}),_export(exports,{fillMetadataSegment:function(){return fillMetadataSegment},normalizeMetadataPageToRoute:function(){return normalizeMetadataPageToRoute},normalizeMetadataRoute:function(){return normalizeMetadataRoute}});const _ismetadataroute=require("./is-metadata-route"),_path=_interop_require_default(require("../../shared/lib/isomorphic/path")),_serverutils=require("../../server/server-utils"),_routeregex=require("../../shared/lib/router/utils/route-regex"),_hash=require("../../shared/lib/hash"),_apppaths=require("../../shared/lib/router/utils/app-paths"),_normalizepathsep=require("../../shared/lib/page-path/normalize-path-sep"),_segment=require("../../shared/lib/segment");function _interop_require_default(e){return e&&e.__esModule?e:{default:e}}function getMetadataRouteSuffix(e){const t=_path.default.dirname(e);if(e.endsWith("/sitemap"))return"";let a="";return t.split("/").some((e=>(0,_segment.isGroupSegment)(e)||(0,_segment.isParallelRouteSegment)(e)))&&(a=(0,_hash.djb2Hash)(t).toString(36).slice(0,6)),a}function fillMetadataSegment(e,t,a){const r=(0,_apppaths.normalizeAppPath)(e),i=(0,_routeregex.getNamedRouteRegex)(r,{prefixRouteKeys:!1}),o=(0,_serverutils.interpolateDynamicPath)(r,t,i),{name:u,ext:n}=_path.default.parse(a),s=getMetadataRouteSuffix(_path.default.posix.join(e,u)),l=s?`-${s}`:"";return(0,_normalizepathsep.normalizePathSep)(_path.default.join(o,`${u}${l}${n}`))}function normalizeMetadataRoute(e){if(!(0,_ismetadataroute.isMetadataRoute)(e))return e;let t=e,a="";if("/robots"===e?t+=".txt":"/manifest"===e?t+=".webmanifest":a=getMetadataRouteSuffix(e),!t.endsWith("/route")){const{dir:e,name:r,ext:i}=_path.default.parse(t);t=_path.default.posix.join(e,`${r}${a?`-${a}`:""}${i}`,"route")}return t}function normalizeMetadataPageToRoute(e,t){const a=e.endsWith("/route"),r=a?e.slice(0,-"/route".length):e,i=r.endsWith("/sitemap")?".xml":"";return(t?`${r}/[__metadata_id__]`:`${r}${i}`)+(a?"/route":"")}