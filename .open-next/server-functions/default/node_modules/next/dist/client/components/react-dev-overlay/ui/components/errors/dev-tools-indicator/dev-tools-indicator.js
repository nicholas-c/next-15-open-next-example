"use strict";function _export(e,n){for(var t in n)Object.defineProperty(e,t,{enumerable:!0,get:n[t]})}Object.defineProperty(exports,"__esModule",{value:!0}),_export(exports,{DEV_TOOLS_INDICATOR_STYLES:function(){return DEV_TOOLS_INDICATOR_STYLES},DevToolsIndicator:function(){return DevToolsIndicator}});const _interop_require_default=require("@swc/helpers/_/_interop_require_default"),_jsxruntime=require("react/jsx-runtime"),_shared=require("../../../../shared"),_react=require("react"),_toast=require("../../toast"),_nextlogo=require("./next-logo"),_initialize=require("../../../../../../dev/dev-build-indicator/internal/initialize"),_devrenderindicator=require("../../../../utils/dev-indicator/dev-render-indicator"),_usedelayedrender=require("../../../hooks/use-delayed-render"),_turbopackinfo=require("./dev-tools-info/turbopack-info"),_routeinfo=require("./dev-tools-info/route-info"),_gearicon=_interop_require_default._(require("../../../icons/gear-icon")),_userpreferences=require("./dev-tools-info/user-preferences"),INDICATOR_POSITION=process.env.__NEXT_DEV_INDICATOR_POSITION||"bottom-left";function DevToolsIndicator(e){let{state:n,errorCount:t,isBuildError:r,setIsErrorOverlayOpen:o}=e;const[i,a]=(0,_react.useState)(!0);return(0,_jsxruntime.jsx)(DevToolsPopover,{routerType:n.routerType,semver:n.versionInfo.installed,issueCount:t,isStaticRoute:n.staticIndicator,hide:()=>{a(!1),fetch("/__nextjs_disable_dev_indicator",{method:"POST"})},setIsErrorOverlayOpen:o,isTurbopack:!!process.env.TURBOPACK,disabled:n.disableDevIndicator||!i,isBuildError:r})}const ANIMATE_OUT_DURATION_MS=200,ANIMATE_OUT_TIMING_FUNCTION="cubic-bezier(0.175, 0.885, 0.32, 1.1)",Context=(0,_react.createContext)({});function getInitialPosition(){return"undefined"!=typeof localStorage&&localStorage.getItem(_shared.STORAGE_KEY_POSITION)?localStorage.getItem(_shared.STORAGE_KEY_POSITION):INDICATOR_POSITION}function DevToolsPopover(e){let{routerType:n,disabled:t,issueCount:r,isStaticRoute:o,isTurbopack:i,isBuildError:a,hide:s,setIsErrorOverlayOpen:l}=e;const u=(0,_react.useRef)(null),d=(0,_react.useRef)(null),c=(0,_react.useRef)(null),v=(0,_react.useRef)(null),x=(0,_react.useRef)(null),_=(0,_react.useRef)(null),p=(0,_react.useRef)(null),f=(0,_react.useRef)(null),[m,g]=(0,_react.useState)(!1),[y,b]=(0,_react.useState)(!1),[T,I]=(0,_react.useState)(!1),[h,O]=(0,_react.useState)(!1),[j,k]=(0,_react.useState)(-1),[D,R]=(0,_react.useState)(getInitialPosition()),{mounted:C,rendered:N}=(0,_usedelayedrender.useDelayedRender)(m,{enterDelay:0,exitDelay:ANIMATE_OUT_DURATION_MS}),{mounted:w,rendered:S}=(0,_usedelayedrender.useDelayedRender)(y,{enterDelay:0,exitDelay:ANIMATE_OUT_DURATION_MS}),{mounted:A,rendered:E}=(0,_usedelayedrender.useDelayedRender)(T,{enterDelay:0,exitDelay:ANIMATE_OUT_DURATION_MS}),{mounted:M,rendered:z}=(0,_usedelayedrender.useDelayedRender)(h,{enterDelay:0,exitDelay:ANIMATE_OUT_DURATION_MS});function L(e){var n;if("first"===e){var t;const e=null==(t=u.current)?void 0:t.querySelectorAll('[role="menuitem"]');if(e){const n=e[0].getAttribute("data-index");L(Number(n))}return}if("last"===e){var r;const e=null==(r=u.current)?void 0:r.querySelectorAll('[role="menuitem"]');if(e){L(e.length-1)}return}const o=null==(n=u.current)?void 0:n.querySelector('[data-index="'+e+'"]');o&&(k(e),null==o||o.focus())}function U(e){switch(e.preventDefault(),e.key){case"ArrowDown":L(j+1);break;case"ArrowUp":L(j-1);break;case"Home":L("first");break;case"End":L("last")}}function P(e){m||("ArrowDown"!==e.key&&"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),g(!0),setTimeout((()=>{L("first")}))),"ArrowUp"===e.key&&(e.preventDefault(),g(!0),setTimeout((()=>{L("last")}))))}function q(){r>0&&l(!0)}function B(){l((e=>!e))}function Y(){g((e=>!e))}function F(){g(!1),setTimeout((()=>{k(-1)}),ANIMATE_OUT_DURATION_MS)}function K(){b(!1)}function X(){I(!1)}function G(){O(!1)}function V(){G(),s()}useFocusTrap(u,d,m),useClickOutside(u,d,m,F),useFocusTrap(c,v,y),useClickOutside(c,v,y,K),useFocusTrap(x,_,T),useClickOutside(x,_,T,X),useFocusTrap(p,f,h),useClickOutside(p,f,h,G);const[H,Z]=D.split("-",2);return(0,_jsxruntime.jsxs)(_toast.Toast,{"data-nextjs-toast":!0,style:{boxShadow:"none",zIndex:2147483647,bottom:"initial",left:"initial",[H]:"10px",[Z]:"20px"},children:[(0,_jsxruntime.jsx)(_nextlogo.NextLogo,{ref:d,"aria-haspopup":"menu","aria-expanded":m,"aria-controls":"nextjs-dev-tools-menu","aria-label":(m?"Close":"Open")+" Next.js Dev Tools","data-nextjs-dev-tools-button":!0,disabled:t,issueCount:r,onTriggerClick:Y,onKeyDown:P,toggleErrorOverlay:B,isDevBuilding:(0,_initialize.useIsDevBuilding)(),isDevRendering:(0,_devrenderindicator.useIsDevRendering)(),isBuildError:a}),A&&(0,_jsxruntime.jsx)(_routeinfo.RouteInfo,{ref:x,routerType:n,routeType:o?"Static":"Dynamic",isOpen:T,setIsOpen:I,setPreviousOpen:g,style:{[H]:"calc(100% + 8px)",[Z]:0},"data-rendered":E}),w&&(0,_jsxruntime.jsx)(_turbopackinfo.TurbopackInfo,{ref:c,isOpen:y,setIsOpen:b,setPreviousOpen:g,style:{[H]:"calc(100% + 8px)",[Z]:0},"data-rendered":S}),M&&(0,_jsxruntime.jsx)(_userpreferences.UserPreferences,{ref:p,isOpen:h,hide:V,setPosition:R,position:D,style:{[H]:"calc(100% + 8px)",[Z]:0},"data-rendered":z}),C&&(0,_jsxruntime.jsx)("div",{ref:u,id:"nextjs-dev-tools-menu",role:"menu",dir:"ltr","aria-orientation":"vertical","aria-label":"Next.js Dev Tools Items",tabIndex:-1,className:"dev-tools-indicator-menu",onKeyDown:U,"data-rendered":N,style:{"--animate-out-duration-ms":ANIMATE_OUT_DURATION_MS+"ms","--animate-out-timing-function":ANIMATE_OUT_TIMING_FUNCTION,[H]:"calc(100% + 8px)",[Z]:0},children:(0,_jsxruntime.jsxs)(Context.Provider,{value:{closeMenu:F,selectedIndex:j,setSelectedIndex:k},children:[(0,_jsxruntime.jsxs)("div",{className:"dev-tools-indicator-inner",children:[r>0&&(0,_jsxruntime.jsx)(MenuItem,{title:r+" "+(1===r?"issue":"issues")+" found. Click to view details in the dev overlay.",index:0,label:"Issues",value:(0,_jsxruntime.jsx)(IssueCount,{children:r}),onClick:q}),(0,_jsxruntime.jsx)(MenuItem,{title:"Current route is "+(o?"static":"dynamic")+".",label:"Route",index:1,value:o?"Static":"Dynamic",onClick:()=>I(!0),"data-nextjs-route-type":o?"static":"dynamic"}),i?(0,_jsxruntime.jsx)(MenuItem,{title:"Turbopack is enabled.",label:"Turbopack",value:"Enabled"}):(0,_jsxruntime.jsx)(MenuItem,{index:2,title:"Learn about Turbopack and how to enable it in your application.",label:"Try Turbopack",value:(0,_jsxruntime.jsx)(ChevronRight,{}),onClick:()=>b(!0)})]}),(0,_jsxruntime.jsx)("div",{className:"dev-tools-indicator-footer",children:(0,_jsxruntime.jsx)(MenuItem,{"data-preferences":!0,label:"Preferences",value:(0,_jsxruntime.jsx)(_gearicon.default,{}),onClick:()=>O(!0),index:i?2:3})})]})})]})}function ChevronRight(){return(0,_jsxruntime.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:(0,_jsxruntime.jsx)("path",{fill:"#666",fillRule:"evenodd",clipRule:"evenodd",d:"M5.50011 1.93945L6.03044 2.46978L10.8537 7.293C11.2442 7.68353 11.2442 8.31669 10.8537 8.70722L6.03044 13.5304L5.50011 14.0608L4.43945 13.0001L4.96978 12.4698L9.43945 8.00011L4.96978 3.53044L4.43945 3.00011L5.50011 1.93945Z"})})}function MenuItem(e){let{index:n,label:t,value:r,onClick:o,href:i,...a}=e;const s="function"==typeof o||"string"==typeof i,{closeMenu:l,selectedIndex:u,setSelectedIndex:d}=(0,_react.useContext)(Context),c=u===n;function v(){s&&(null==o||o(),l(),i&&window.open(i,"_blank","noopener, noreferrer"))}return(0,_jsxruntime.jsxs)("div",{className:"dev-tools-indicator-item","data-index":n,"data-selected":c,onClick:v,onMouseMove:()=>{s&&void 0!==n&&u!==n&&d(n)},onMouseLeave:()=>d(-1),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||v()},role:s?"menuitem":void 0,tabIndex:c?0:-1,...a,children:[(0,_jsxruntime.jsx)("span",{className:"dev-tools-indicator-label",children:t}),(0,_jsxruntime.jsx)("span",{className:"dev-tools-indicator-value",children:r})]})}function IssueCount(e){let{children:n}=e;return(0,_jsxruntime.jsxs)("span",{className:"dev-tools-indicator-issue-count","data-has-issues":n>0,children:[(0,_jsxruntime.jsx)("span",{className:"dev-tools-indicator-issue-count-indicator"}),n]})}function useFocusTrap(e,n,t){(0,_react.useEffect)((()=>{if(t){var r;null==(r=e.current)||r.focus()}else{var o,i;const t=null==(o=n.current)?void 0:o.getRootNode(),r=t instanceof ShadowRoot?null==t?void 0:t.activeElement:null;var a;if(null==(i=e.current)?void 0:i.contains(r))null==(a=n.current)||a.focus()}}),[t])}function useClickOutside(e,n,t,r){(0,_react.useEffect)((()=>{if(!t)return;const o=t=>{var o,i;(null==(o=e.current)?void 0:o.getBoundingClientRect())&&t.clientX>=e.current.getBoundingClientRect().left&&t.clientX<=e.current.getBoundingClientRect().right&&t.clientY>=e.current.getBoundingClientRect().top&&t.clientY<=e.current.getBoundingClientRect().bottom||(null==(i=n.current)?void 0:i.getBoundingClientRect())&&t.clientX>=n.current.getBoundingClientRect().left&&t.clientX<=n.current.getBoundingClientRect().right&&t.clientY>=n.current.getBoundingClientRect().top&&t.clientY<=n.current.getBoundingClientRect().bottom||r()},i=e=>{"Escape"===e.key&&r()};return document.addEventListener("mousedown",o),document.addEventListener("keydown",i),()=>{document.removeEventListener("mousedown",o),document.removeEventListener("keydown",i)}}),[t])}const DEV_TOOLS_INDICATOR_STYLES="\n  .dev-tools-indicator-menu {\n    -webkit-font-smoothing: antialiased;\n    display: flex;\n    flex-direction: column;\n    align-items: flex-start;\n    background: var(--color-background-100);\n    border: 1px solid var(--color-gray-alpha-400);\n    background-clip: padding-box;\n    box-shadow: var(--shadow-menu);\n    border-radius: var(--rounded-xl);\n    position: absolute;\n    font-family: var(--font-stack-sans);\n    z-index: 1000;\n    overflow: hidden;\n    opacity: 0;\n    outline: 0;\n    min-width: 248px;\n    transition: opacity var(--animate-out-duration-ms)\n      var(--animate-out-timing-function);\n\n    &[data-rendered='true'] {\n      opacity: 1;\n      scale: 1;\n    }\n  }\n\n  .dev-tools-indicator-inner {\n    padding: 6px;\n    width: 100%;\n  }\n\n  .dev-tools-indicator-item {\n    display: flex;\n    align-items: center;\n    padding: 8px 6px;\n    height: var(--size-36);\n    border-radius: 6px;\n    text-decoration: none !important;\n    user-select: none;\n    white-space: nowrap;\n\n    svg {\n      width: var(--size-16);\n      height: var(--size-16);\n    }\n\n    &:focus-visible {\n      outline: 0;\n    }\n  }\n\n  .dev-tools-indicator-footer {\n    background: var(--color-background-200);\n    padding: 6px;\n    border-top: 1px solid var(--color-gray-400);\n    width: 100%;\n  }\n\n  .dev-tools-indicator-item[data-selected='true'] {\n    cursor: pointer;\n    background-color: var(--color-gray-200);\n  }\n\n  .dev-tools-indicator-label {\n    font-size: var(--size-14);\n    line-height: var(--size-20);\n    color: var(--color-gray-1000);\n  }\n\n  .dev-tools-indicator-value {\n    font-size: var(--size-14);\n    line-height: var(--size-20);\n    color: var(--color-gray-900);\n    margin-left: auto;\n  }\n\n  .dev-tools-indicator-issue-count {\n    --color-primary: var(--color-gray-800);\n    --color-secondary: var(--color-gray-100);\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: center;\n    gap: 8px;\n    min-width: var(--size-40);\n    height: var(--size-24);\n    background: var(--color-background-100);\n    border: 1px solid var(--color-gray-alpha-400);\n    background-clip: padding-box;\n    box-shadow: var(--shadow-small);\n    padding: 2px;\n    color: var(--color-gray-1000);\n    border-radius: 128px;\n    font-weight: 500;\n    font-size: var(--size-13);\n    font-variant-numeric: tabular-nums;\n\n    &[data-has-issues='true'] {\n      --color-primary: var(--color-red-800);\n      --color-secondary: var(--color-red-100);\n    }\n\n    .dev-tools-indicator-issue-count-indicator {\n      width: var(--size-8);\n      height: var(--size-8);\n      background: var(--color-primary);\n      box-shadow: 0 0 0 2px var(--color-secondary);\n      border-radius: 50%;\n    }\n  }\n\n  .dev-tools-indicator-shortcut {\n    display: flex;\n    gap: 4px;\n\n    kbd {\n      width: var(--size-20);\n      height: var(--size-20);\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      border-radius: var(--rounded-md);\n      border: 1px solid var(--color-gray-400);\n      font-family: var(--font-stack-sans);\n      background: var(--color-background-100);\n      color: var(--color-gray-1000);\n      text-align: center;\n      font-size: var(--size-12);\n      line-height: var(--size-16);\n    }\n  }\n";("function"==typeof exports.default||"object"==typeof exports.default&&null!==exports.default)&&void 0===exports.default.__esModule&&(Object.defineProperty(exports.default,"__esModule",{value:!0}),Object.assign(exports.default,exports),module.exports=exports.default);