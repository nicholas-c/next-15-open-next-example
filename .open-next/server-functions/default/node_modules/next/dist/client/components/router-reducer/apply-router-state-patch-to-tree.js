"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"applyRouterStatePatchToTree",{enumerable:!0,get:function(){return applyRouterStatePatchToTree}});const _segment=require("../../../shared/lib/segment"),_flightdatahelpers=require("../../flight-data-helpers"),_matchsegments=require("../match-segments"),_refetchinactiveparallelsegments=require("./refetch-inactive-parallel-segments");function applyPatch(e,t){const[r,a]=e,[n,l]=t;if(n===_segment.DEFAULT_SEGMENT_KEY&&r!==_segment.DEFAULT_SEGMENT_KEY)return e;if((0,_matchsegments.matchSegment)(r,n)){const t={};for(const e in a){const r=void 0!==l[e];t[e]=r?applyPatch(a[e],l[e]):a[e]}for(const e in l)t[e]||(t[e]=l[e]);const n=[r,t];return e[2]&&(n[2]=e[2]),e[3]&&(n[3]=e[3]),e[4]&&(n[4]=e[4]),n}return t}function applyRouterStatePatchToTree(e,t,r,a){const[n,l,s,o,c]=t;if(1===e.length){const e=applyPatch(t,r);return(0,_refetchinactiveparallelsegments.addRefreshMarkerToActiveParallelSegments)(e,a),e}const[p,u]=e;if(!(0,_matchsegments.matchSegment)(p,n))return null;let i;if(2===e.length)i=applyPatch(l[u],r);else if(i=applyRouterStatePatchToTree((0,_flightdatahelpers.getNextFlightSegmentPath)(e),l[u],r,a),null===i)return null;const f=[e[0],{...l,[u]:i},s,o];return c&&(f[4]=!0),(0,_refetchinactiveparallelsegments.addRefreshMarkerToActiveParallelSegments)(f,a),f}("function"==typeof exports.default||"object"==typeof exports.default&&null!==exports.default)&&void 0===exports.default.__esModule&&(Object.defineProperty(exports.default,"__esModule",{value:!0}),Object.assign(exports.default,exports),module.exports=exports.default);