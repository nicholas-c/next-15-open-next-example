"use strict";function _export(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}Object.defineProperty(exports,"__esModule",{value:!0}),_export(exports,{useSendMessage:function(){return useSendMessage},useTurbopack:function(){return useTurbopack},useWebsocket:function(){return useWebsocket},useWebsocketPing:function(){return useWebsocketPing}});const _react=require("react"),_approutercontextsharedruntime=require("../../../../shared/lib/app-router-context.shared-runtime"),_getsocketurl=require("./get-socket-url");function useWebsocket(e){const t=(0,_react.useRef)(void 0);return(0,_react.useEffect)((()=>{if(t.current)return;const r=(0,_getsocketurl.getSocketUrl)(e);t.current=new window.WebSocket(r+"/_next/webpack-hmr")}),[e]),t}function useSendMessage(e){return(0,_react.useCallback)((t=>{const r=e.current;if(r&&r.readyState===r.OPEN)return r.send(t)}),[e])}function useTurbopack(e,t){const r=(0,_react.useRef)({init:!1,queue:[],callback:void 0}),u=(0,_react.useCallback)((e=>{const{callback:t,queue:u}=r.current;t?t(e):u.push(e)}),[]);return(0,_react.useEffect)((()=>{const{current:u}=r;u.init||(u.init=!0,import("@vercel/turbopack-ecmascript-runtime/browser/dev/hmr-client/hmr-client.ts").then((u=>{let{connect:n}=u;const{current:s}=r;n({addMessageListener(e){s.callback=e;for(const t of s.queue)e(t);s.queue=void 0},sendMessage:e,onUpdateError:t})})))}),[e,t]),u}function useWebsocketPing(e){const t=useSendMessage(e),{tree:r}=(0,_react.useContext)(_approutercontextsharedruntime.GlobalLayoutRouterContext);(0,_react.useEffect)((()=>{if(process.env.TURBOPACK)return;const e=setInterval((()=>{t(JSON.stringify({event:"ping",tree:r,appDirRoute:!0}))}),2500);return()=>clearInterval(e)}),[r,t])}("function"==typeof exports.default||"object"==typeof exports.default&&null!==exports.default)&&void 0===exports.default.__esModule&&(Object.defineProperty(exports.default,"__esModule",{value:!0}),Object.assign(exports.default,exports),module.exports=exports.default);