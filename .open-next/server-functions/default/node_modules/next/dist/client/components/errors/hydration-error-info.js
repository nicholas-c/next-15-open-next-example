"use strict";function _export(t,e){for(var n in e)Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}Object.defineProperty(exports,"__esModule",{value:!0}),_export(exports,{getHydrationWarningType:function(){return getHydrationWarningType},getReactHydrationDiffSegments:function(){return getReactHydrationDiffSegments},hydrationErrorState:function(){return hydrationErrorState},storeHydrationErrorStateFromConsoleArgs:function(){return storeHydrationErrorStateFromConsoleArgs}});const _ishydrationerror=require("../is-hydration-error"),hydrationErrorState={},htmlTagsWarnings=new Set(["Warning: In HTML, %s cannot be a child of <%s>.%s\nThis will cause a hydration error.%s","Warning: In HTML, %s cannot be a descendant of <%s>.\nThis will cause a hydration error.%s","Warning: In HTML, text nodes cannot be a child of <%s>.\nThis will cause a hydration error.","Warning: In HTML, whitespace text nodes cannot be a child of <%s>. Make sure you don't have any extra whitespace between tags on each line of your source code.\nThis will cause a hydration error.","Warning: Expected server HTML to contain a matching <%s> in <%s>.%s","Warning: Did not expect server HTML to contain a <%s> in <%s>.%s"]),textAndTagsMismatchWarnings=new Set(['Warning: Expected server HTML to contain a matching text node for "%s" in <%s>.%s','Warning: Did not expect server HTML to contain the text node "%s" in <%s>.%s']),getHydrationWarningType=t=>{if("string"!=typeof t)return"text";const e=t.startsWith("Warning: ")?t:"Warning: "+t;return isHtmlTagsWarning(e)?"tag":isTextInTagsMismatchWarning(e)?"text-in-tag":"text"},isHtmlTagsWarning=t=>htmlTagsWarnings.has(t),isTextInTagsMismatchWarning=t=>textAndTagsMismatchWarnings.has(t),getReactHydrationDiffSegments=t=>{if(t){const{message:e,diff:n}=(0,_ishydrationerror.getHydrationErrorStackInfo)(t);if(e)return[e,n]}};function storeHydrationErrorStateFromConsoleArgs(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];let[r,a,o,...i]=e;if((0,_ishydrationerror.testReactHydrationWarning)(r)){const t=r.startsWith("Warning: ");3===e.length&&(o="");const n=[r,a,o],s=(i[i.length-1]||"").trim();hydrationErrorState.reactOutputComponentDiff=t?generateHydrationDiffReact18(r,a,o,s):s,hydrationErrorState.warning=n,hydrationErrorState.serverContent=a,hydrationErrorState.clientContent=o}}function generateHydrationDiffReact18(t,e,n,r){const a=r;let o=-1,i=-1;const s=getHydrationWarningType(t),g=a.split("\n").map(((t,r)=>{t=t.trim();const[,a,s]=/at (\w+)( \((.*)\))?/.exec(t)||[];return s||(a===e&&-1===o?o=r:a===n&&-1===i&&(i=r)),s?"":a})).filter(Boolean).reverse();let c="";for(let t=0;t<g.length;t++){const e=g[t],n="tag"===s&&t===g.length-o-1,r="tag"===s&&t===g.length-i-1;if(n||r){c+="> "+" ".repeat(Math.max(2*t-2,0)+2)+"<"+e+">\n"}else{c+=" ".repeat(2*t+2)+"<"+e+">\n"}}if("text"===s){const t=" ".repeat(2*g.length);c+="+ "+t+'"'+e+'"\n',c+="- "+t+'"'+n+'"\n'}else if("text-in-tag"===s){const t=" ".repeat(2*g.length);c+="> "+t+"<"+n+">\n",c+=">   "+t+'"'+e+'"\n'}return c}("function"==typeof exports.default||"object"==typeof exports.default&&null!==exports.default)&&void 0===exports.default.__esModule&&(Object.defineProperty(exports.default,"__esModule",{value:!0}),Object.assign(exports.default,exports),module.exports=exports.default);