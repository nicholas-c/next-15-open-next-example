"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"PromiseQueue",{enumerable:!0,get:function(){return PromiseQueue}});const _class_private_field_loose_base=require("@swc/helpers/_/_class_private_field_loose_base"),_class_private_field_loose_key=require("@swc/helpers/_/_class_private_field_loose_key");var _maxConcurrency=_class_private_field_loose_key._("_maxConcurrency"),_runningCount=_class_private_field_loose_key._("_runningCount"),_queue=_class_private_field_loose_key._("_queue"),_processNext=_class_private_field_loose_key._("_processNext");class PromiseQueue{enqueue(e){let _,s;const t=new Promise(((e,t)=>{_=e,s=t})),o={promiseFn:t,task:async()=>{try{_class_private_field_loose_base._(this,_runningCount)[_runningCount]++;const s=await e();_(s)}catch(e){s(e)}finally{_class_private_field_loose_base._(this,_runningCount)[_runningCount]--,_class_private_field_loose_base._(this,_processNext)[_processNext]()}}};return _class_private_field_loose_base._(this,_queue)[_queue].push(o),_class_private_field_loose_base._(this,_processNext)[_processNext](),t}bump(e){const _=_class_private_field_loose_base._(this,_queue)[_queue].findIndex((_=>_.promiseFn===e));if(_>-1){const e=_class_private_field_loose_base._(this,_queue)[_queue].splice(_,1)[0];_class_private_field_loose_base._(this,_queue)[_queue].unshift(e),_class_private_field_loose_base._(this,_processNext)[_processNext](!0)}}constructor(e=5){Object.defineProperty(this,_processNext,{value:processNext}),Object.defineProperty(this,_maxConcurrency,{writable:!0,value:void 0}),Object.defineProperty(this,_runningCount,{writable:!0,value:void 0}),Object.defineProperty(this,_queue,{writable:!0,value:void 0}),_class_private_field_loose_base._(this,_maxConcurrency)[_maxConcurrency]=e,_class_private_field_loose_base._(this,_runningCount)[_runningCount]=0,_class_private_field_loose_base._(this,_queue)[_queue]=[]}}function processNext(e){var _;(void 0===e&&(e=!1),(_class_private_field_loose_base._(this,_runningCount)[_runningCount]<_class_private_field_loose_base._(this,_maxConcurrency)[_maxConcurrency]||e)&&_class_private_field_loose_base._(this,_queue)[_queue].length>0)&&(null==(_=_class_private_field_loose_base._(this,_queue)[_queue].shift())||_.task())}("function"==typeof exports.default||"object"==typeof exports.default&&null!==exports.default)&&void 0===exports.default.__esModule&&(Object.defineProperty(exports.default,"__esModule",{value:!0}),Object.assign(exports.default,exports),module.exports=exports.default);