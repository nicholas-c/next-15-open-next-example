"use strict";function _export(e,t){for(var o in t)Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}Object.defineProperty(exports,"__esModule",{value:!0}),_export(exports,{getTestReqInfo:function(){return getTestReqInfo},withRequest:function(){return withRequest}});const _nodeasync_hooks=require("node:async_hooks"),testStorage=new _nodeasync_hooks.AsyncLocalStorage;function extractTestInfoFromRequest(e,t){const o=t.header(e,"next-test-proxy-port");if(!o)return;return{url:t.url(e),proxyPort:Number(o),testData:t.header(e,"next-test-data")||""}}function withRequest(e,t,o){const r=extractTestInfoFromRequest(e,t);return r?testStorage.run(r,o):o()}function getTestReqInfo(e,t){const o=testStorage.getStore();return o||(e&&t?extractTestInfoFromRequest(e,t):void 0)}