"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"CopyFilePlugin",{enumerable:!0,get:function(){return CopyFilePlugin}});const _fs=require("fs"),_loaderutils3=_interop_require_default(require("next/dist/compiled/loader-utils3")),_webpack=require("next/dist/compiled/webpack/webpack");function _interop_require_default(e){return e&&e.__esModule?e:{default:e}}const PLUGIN_NAME="CopyFilePlugin";class CopyFilePlugin{constructor({filePath:e,cacheKey:t,name:i,info:s}){this.filePath=e,this.cacheKey=t,this.name=i,this.info=s}apply(e){e.hooks.thisCompilation.tap(PLUGIN_NAME,(t=>{const i=t.getCache("CopyFilePlugin");t.hooks.processAssets.tapPromise({name:PLUGIN_NAME,stage:_webpack.webpack.Compilation.PROCESS_ASSETS_STAGE_ADDITIONS},(async()=>{if(i){const e=await i.getPromise(this.filePath,this.cacheKey);if(e){const{file:i,source:s}=e;return void t.emitAsset(i,s,{...this.info})}}const s=await _fs.promises.readFile(this.filePath,"utf8"),o=_loaderutils3.default.interpolateName({resourcePath:this.filePath},this.name,{content:s,context:e.context}),a=new _webpack.sources.RawSource(s);i&&await i.storePromise(this.filePath,this.cacheKey,{file:o,source:a}),t.emitAsset(o,a,{...this.info})}))}))}}