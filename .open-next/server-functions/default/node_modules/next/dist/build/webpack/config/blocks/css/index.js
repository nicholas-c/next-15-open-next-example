"use strict";function _export(e,s){for(var r in s)Object.defineProperty(e,r,{enumerable:!0,get:s[r]})}Object.defineProperty(exports,"__esModule",{value:!0}),_export(exports,{css:function(){return css},lazyPostCSS:function(){return lazyPostCSS},regexLikeCss:function(){return regexLikeCss}});const _lodashcurry=_interop_require_default(require("next/dist/compiled/lodash.curry")),_helpers=require("../../helpers"),_utils=require("../../utils"),_loaders=require("./loaders"),_nextfont=require("./loaders/next-font"),_messages=require("./messages"),_plugins=require("./plugins"),_nonnullable=require("../../../../../lib/non-nullable"),_constants=require("../../../../../lib/constants"),_getrspack=require("../../../../../shared/lib/get-rspack");function _interop_require_default(e){return e&&e.__esModule?e:{default:e}}const regexLikeCss=/\.(css|scss|sass)$/,regexCssGlobal=/(?<!\.module)\.css$/,regexCssModules=/\.module\.css$/,regexSassGlobal=/(?<!\.module)\.(scss|sass)$/,regexSassModules=/\.module\.(scss|sass)$/,APP_LAYER_RULE={or:[_constants.WEBPACK_LAYERS.reactServerComponents,_constants.WEBPACK_LAYERS.serverSideRendering,_constants.WEBPACK_LAYERS.appPagesBrowser]},PAGES_LAYER_RULE={not:[_constants.WEBPACK_LAYERS.reactServerComponents,_constants.WEBPACK_LAYERS.serverSideRendering,_constants.WEBPACK_LAYERS.appPagesBrowser]};function markRemovable(e){return Object.defineProperty(e,Symbol.for("__next_css_remove"),{enumerable:!1,value:!0}),e}let postcssInstancePromise;async function lazyPostCSS(e,s,r,o){return postcssInstancePromise||(postcssInstancePromise=(async()=>{const l=require("postcss");l.plugin=function(e,s){function r(...r){let o=s(...r);return o.postcssPlugin=e,o}let o;return Object.defineProperty(r,"postcss",{get:()=>(o||(o=r()),o)}),r.process=function(e,s,o){return l([r(o)]).process(e,s)},r},l.vendor={prefix:function(e){const s=e.match(/^(-\w+-)/);return s?s[0]:""},unprefixed:function(e){return e.replace(/^-\w+-/,"")}};const t=await(0,_plugins.getPostCssPlugins)(e,s,r,o);return{postcss:l,postcssWithPlugins:l(t)}})()),postcssInstancePromise}const css=(0,_lodashcurry.default)((async function(e,s){const r=Boolean(process.env.NEXT_RSPACK),{prependData:o,additionalData:l,implementation:t,...a}=e.sassOptions,n=()=>lazyPostCSS(e.rootDirectory,e.supportedBrowsers,e.experimental.disablePostcssPresetEnv,e.experimental.useLightningcss),i=[{loader:require.resolve("next/dist/compiled/sass-loader"),options:{implementation:t,sourceMap:!0,sassOptions:{fibers:!1,silenceDeprecations:["legacy-js-api"],...a},additionalData:o||l}},{loader:require.resolve("../../../loaders/resolve-url-loader/index"),options:{postcss:n,sourceMap:!0}}],u=[],d=require.resolve("next/dist/compiled/@next/font/google/loader"),c=require.resolve("next/dist/compiled/@next/font/local/loader");[[require.resolve("next/font/google/target.css"),d],[require.resolve("next/font/local/target.css"),c]].forEach((([s,r])=>{u.push((0,_helpers.loader)({oneOf:[markRemovable({sideEffects:!1,test:s,use:(0,_nextfont.getNextFontLoader)(e,n,r)})]}))})),u.push((0,_helpers.loader)({oneOf:[markRemovable({test:regexLikeCss,issuer:/pages[\\/]_document\./,use:{loader:"error-loader",options:{reason:(0,_messages.getCustomDocumentError)()}}})]}));const p=!!e.experimental.craCompat||!!e.transpilePackages;if(u.push((0,_helpers.loader)({oneOf:[e.hasAppDir?markRemovable({sideEffects:!0,test:regexCssModules,issuerLayer:APP_LAYER_RULE,use:[{loader:require.resolve("../../../loaders/next-flight-css-loader"),options:{cssModules:!0}},...(0,_loaders.getCssModuleLoader)({...e,isAppDir:!0},n)]}):null,markRemovable({sideEffects:!0,test:regexCssModules,issuerLayer:PAGES_LAYER_RULE,use:(0,_loaders.getCssModuleLoader)({...e,isAppDir:!1},n)})].filter(_nonnullable.nonNullable)}),(0,_helpers.loader)({oneOf:[e.hasAppDir?markRemovable({sideEffects:!0,test:regexSassModules,issuerLayer:APP_LAYER_RULE,use:[{loader:require.resolve("../../../loaders/next-flight-css-loader"),options:{cssModules:!0}},...(0,_loaders.getCssModuleLoader)({...e,isAppDir:!0},n,i)]}):null,markRemovable({sideEffects:!0,test:regexSassModules,issuerLayer:PAGES_LAYER_RULE,use:(0,_loaders.getCssModuleLoader)({...e,isAppDir:!1},n,i)})].filter(_nonnullable.nonNullable)}),(0,_helpers.loader)({oneOf:[markRemovable({test:[regexCssModules,regexSassModules],use:{loader:"error-loader",options:{reason:(0,_messages.getLocalModuleImportError)()}}})]})),e.isServer)u.push((0,_helpers.loader)({oneOf:[e.hasAppDir&&!e.isProduction?markRemovable({sideEffects:!0,test:[regexCssGlobal,regexSassGlobal],issuerLayer:APP_LAYER_RULE,use:{loader:require.resolve("../../../loaders/next-flight-css-loader"),options:{cssModules:!1}}}):null,markRemovable({sideEffects:!0,test:[regexCssGlobal,regexSassGlobal],use:require.resolve("next/dist/compiled/ignore-loader")})].filter(_nonnullable.nonNullable)}));else{const s=e.hasAppDir?void 0:{and:[{or:[/node_modules/,{not:[e.rootDirectory]}]}]},r=e.hasAppDir||p?void 0:{and:[e.rootDirectory],not:[/node_modules/]};u.push((0,_helpers.loader)({oneOf:[...e.hasAppDir?[markRemovable({sideEffects:!0,test:regexCssGlobal,issuerLayer:APP_LAYER_RULE,use:[{loader:require.resolve("../../../loaders/next-flight-css-loader"),options:{cssModules:!1}},...(0,_loaders.getGlobalCssLoader)({...e,isAppDir:!0},n)]}),markRemovable({sideEffects:!0,test:regexSassGlobal,issuerLayer:APP_LAYER_RULE,use:[{loader:require.resolve("../../../loaders/next-flight-css-loader"),options:{cssModules:!1}},...(0,_loaders.getGlobalCssLoader)({...e,isAppDir:!0},n,i)]})]:[],markRemovable({sideEffects:!0,test:regexCssGlobal,include:s,issuer:r,issuerLayer:PAGES_LAYER_RULE,use:(0,_loaders.getGlobalCssLoader)({...e,isAppDir:!1},n)}),markRemovable({sideEffects:!0,test:regexSassGlobal,include:s,issuer:r,issuerLayer:PAGES_LAYER_RULE,use:(0,_loaders.getGlobalCssLoader)({...e,isAppDir:!1},n,i)})].filter(_nonnullable.nonNullable)})),e.customAppFile&&u.push((0,_helpers.loader)({oneOf:[markRemovable({sideEffects:!0,test:regexCssGlobal,issuer:{and:[e.customAppFile]},use:(0,_loaders.getGlobalCssLoader)({...e,isAppDir:!1},n)})]}),(0,_helpers.loader)({oneOf:[markRemovable({sideEffects:!0,test:regexSassGlobal,issuer:{and:[e.customAppFile]},use:(0,_loaders.getGlobalCssLoader)({...e,isAppDir:!1},n,i)})]}))}if(p||u.push((0,_helpers.loader)({oneOf:[markRemovable({test:[regexCssGlobal,regexSassGlobal],issuer:{and:[/node_modules/]},use:{loader:"error-loader",options:{reason:(0,_messages.getGlobalModuleImportError)()}}})]})),u.push((0,_helpers.loader)({oneOf:[markRemovable({test:[regexCssGlobal,regexSassGlobal],issuer:e.hasAppDir?{and:[e.rootDirectory],not:[/layout\.(js|mjs|jsx|ts|tsx)$/]}:void 0,use:{loader:"error-loader",options:{reason:(0,_messages.getGlobalImportError)()}}})]})),e.isClient&&u.push((0,_helpers.loader)({oneOf:[markRemovable({issuer:regexLikeCss,exclude:[/\.(js|mjs|jsx|ts|tsx)$/,/\.html$/,/\.json$/,/\.webpack\[[^\]]+\]$/],type:"asset/resource"})]})),e.isClient&&(e.isProduction||e.hasAppDir)){const s=r?(0,_getrspack.getRspackCore)().CssExtractRspackPlugin:require("../../../plugins/mini-css-extract-plugin").default;u.push((0,_helpers.plugin)(new s({filename:e.isProduction?"static/css/[contenthash].css":"static/css/[name].css",chunkFilename:e.isProduction?"static/css/[contenthash].css":"static/css/[name].css",ignoreOrder:!0,insert:function(e){if("function"==typeof _N_E_STYLE_LOAD){const{href:s,onload:r,onerror:o}=e;_N_E_STYLE_LOAD(0===s.indexOf(window.location.origin)?new URL(s).pathname:s).then((()=>null==r?void 0:r.call(e,{type:"load"})),(()=>null==o?void 0:o.call(e,{})))}else document.head.appendChild(e)}})))}return(0,_utils.pipe)(...u)(s)}));