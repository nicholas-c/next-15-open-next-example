"use strict";function _export(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}Object.defineProperty(exports,"__esModule",{value:!0}),_export(exports,{default:function(){return _default},getRouteLoaderEntry:function(){return getRouteLoaderEntry}});const _querystring=require("querystring"),_getmodulebuildinfo=require("../get-module-build-info"),_routekind=require("../../../../server/route-kind"),_normalizepagepath=require("../../../../shared/lib/page-path/normalize-page-path"),_utils=require("../utils"),_utils1=require("../../../utils"),_loadentrypoint=require("../../../load-entrypoint");function getRouteLoaderEntry(e){switch(e.kind){case _routekind.RouteKind.PAGES:{const t={kind:e.kind,page:e.page,preferredRegion:e.preferredRegion,absolutePagePath:e.absolutePagePath,absoluteAppPath:e.pages["/_app"],absoluteDocumentPath:e.pages["/_document"],middlewareConfigBase64:(0,_utils.encodeToBase64)(e.middlewareConfig)};return`next-route-loader?${(0,_querystring.stringify)(t)}!`}case _routekind.RouteKind.PAGES_API:{const t={kind:e.kind,page:e.page,preferredRegion:e.preferredRegion,absolutePagePath:e.absolutePagePath,middlewareConfigBase64:(0,_utils.encodeToBase64)(e.middlewareConfig)};return`next-route-loader?${(0,_querystring.stringify)(t)}!`}default:throw Object.defineProperty(new Error("Invariant: Unexpected route kind"),"__NEXT_ERROR_CODE",{value:"E453",enumerable:!1,configurable:!0})}}const loadPages=async({page:e,absolutePagePath:t,absoluteDocumentPath:r,absoluteAppPath:a,preferredRegion:o,middlewareConfigBase64:n},i)=>{const u=(0,_utils.decodeFromBase64)(n);i.route={page:e,absolutePagePath:t,preferredRegion:o,middlewareConfig:u};let d=await(0,_loadentrypoint.loadEntrypoint)("pages",{VAR_USERLAND:t,VAR_MODULE_DOCUMENT:r,VAR_MODULE_APP:a,VAR_DEFINITION_PAGE:(0,_normalizepagepath.normalizePagePath)(e),VAR_DEFINITION_PATHNAME:e});return(0,_utils1.isInstrumentationHookFile)(e)&&(d+='\nexport const register = hoist(userland, "register")'),d},loadPagesAPI=async({page:e,absolutePagePath:t,preferredRegion:r,middlewareConfigBase64:a},o)=>{const n=(0,_utils.decodeFromBase64)(a);return o.route={page:e,absolutePagePath:t,preferredRegion:r,middlewareConfig:n},await(0,_loadentrypoint.loadEntrypoint)("pages-api",{VAR_USERLAND:t,VAR_DEFINITION_PAGE:(0,_normalizepagepath.normalizePagePath)(e),VAR_DEFINITION_PATHNAME:e})},loader=async function(){if(!this._module)throw Object.defineProperty(new Error("Invariant: expected this to reference a module"),"__NEXT_ERROR_CODE",{value:"E383",enumerable:!1,configurable:!0});const e=(0,_getmodulebuildinfo.getModuleBuildInfo)(this._module),t=this.getOptions();switch(t.kind){case _routekind.RouteKind.PAGES:return await loadPages(t,e);case _routekind.RouteKind.PAGES_API:return await loadPagesAPI(t,e);default:throw Object.defineProperty(new Error("Invariant: Unexpected route kind"),"__NEXT_ERROR_CODE",{value:"E453",enumerable:!1,configurable:!0})}},_default=loader;