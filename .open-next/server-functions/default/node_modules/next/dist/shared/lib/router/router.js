"use strict";function _export(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}Object.defineProperty(exports,"__esModule",{value:!0}),_export(exports,{createKey:function(){return createKey},default:function(){return Router},matchesMiddleware:function(){return matchesMiddleware}});const _interop_require_default=require("@swc/helpers/_/_interop_require_default"),_interop_require_wildcard=require("@swc/helpers/_/_interop_require_wildcard"),_removetrailingslash=require("./utils/remove-trailing-slash"),_routeloader=require("../../../client/route-loader"),_script=require("../../../client/script"),_iserror=_interop_require_wildcard._(require("../../../lib/is-error")),_denormalizepagepath=require("../page-path/denormalize-page-path"),_normalizelocalepath=require("../i18n/normalize-locale-path"),_mitt=_interop_require_default._(require("../mitt")),_utils=require("../utils"),_isdynamic=require("./utils/is-dynamic"),_parserelativeurl=require("./utils/parse-relative-url"),_resolverewrites=_interop_require_default._(require("./utils/resolve-rewrites")),_routematcher=require("./utils/route-matcher"),_routeregex=require("./utils/route-regex"),_formaturl=require("./utils/format-url"),_detectdomainlocale=require("../../../client/detect-domain-locale"),_parsepath=require("./utils/parse-path"),_addlocale=require("../../../client/add-locale"),_removelocale=require("../../../client/remove-locale"),_removebasepath=require("../../../client/remove-base-path"),_addbasepath=require("../../../client/add-base-path"),_hasbasepath=require("../../../client/has-base-path"),_resolvehref=require("../../../client/resolve-href"),_isapiroute=require("../../../lib/is-api-route"),_getnextpathnameinfo=require("./utils/get-next-pathname-info"),_formatnextpathnameinfo=require("./utils/format-next-pathname-info"),_comparestates=require("./utils/compare-states"),_islocalurl=require("./utils/is-local-url"),_isbot=require("./utils/is-bot"),_omit=require("./utils/omit"),_interpolateas=require("./utils/interpolate-as"),_handlesmoothscroll=require("./utils/handle-smooth-scroll"),_constants=require("../../../lib/constants");function buildCancellationError(){return Object.assign(Object.defineProperty(new Error("Route Cancelled"),"__NEXT_ERROR_CODE",{value:"E315",enumerable:!1,configurable:!0}),{cancelled:!0})}async function matchesMiddleware(e){const t=await Promise.resolve(e.router.pageLoader.getMiddleware());if(!t)return!1;const{pathname:a}=(0,_parsepath.parsePath)(e.asPath),r=(0,_hasbasepath.hasBasePath)(a)?(0,_removebasepath.removeBasePath)(a):a,s=(0,_addbasepath.addBasePath)((0,_addlocale.addLocale)(r,e.locale));return t.some((e=>new RegExp(e.regexp).test(s)))}function stripOrigin(e){const t=(0,_utils.getLocationOrigin)();return e.startsWith(t)?e.substring(t.length):e}function prepareUrlAs(e,t,a){let[r,s]=(0,_resolvehref.resolveHref)(e,t,!0);const o=(0,_utils.getLocationOrigin)(),i=r.startsWith(o),l=s&&s.startsWith(o);r=stripOrigin(r),s=s?stripOrigin(s):s;const n=i?r:(0,_addbasepath.addBasePath)(r),h=a?stripOrigin((0,_resolvehref.resolveHref)(e,a)):s||r;return{url:n,as:l?h:(0,_addbasepath.addBasePath)(h)}}function resolveDynamicRoute(e,t){const a=(0,_removetrailingslash.removeTrailingSlash)((0,_denormalizepagepath.denormalizePagePath)(e));return"/404"===a||"/_error"===a?e:(t.includes(a)||t.some((t=>{if((0,_isdynamic.isDynamicRoute)(t)&&(0,_routeregex.getRouteRegex)(t).re.test(a))return e=t,!0})),(0,_removetrailingslash.removeTrailingSlash)(e))}function getMiddlewareData(e,t,a){const r={basePath:a.router.basePath,i18n:{locales:a.router.locales},trailingSlash:Boolean(process.env.__NEXT_TRAILING_SLASH)},s=t.headers.get("x-nextjs-rewrite");let o=s||t.headers.get("x-nextjs-matched-path");const i=t.headers.get(_constants.MATCHED_PATH_HEADER);if(!i||o||i.includes("__next_data_catchall")||i.includes("/_error")||i.includes("/404")||(o=i),o){if(o.startsWith("/")||process.env.__NEXT_EXTERNAL_MIDDLEWARE_REWRITE_RESOLVE){const t=(0,_parserelativeurl.parseRelativeUrl)(o),i=(0,_getnextpathnameinfo.getNextPathnameInfo)(t.pathname,{nextConfig:r,parseData:!0});let l=(0,_removetrailingslash.removeTrailingSlash)(i.pathname);return Promise.all([a.router.pageLoader.getPageList(),(0,_routeloader.getClientBuildManifest)()]).then((o=>{let[n,{__rewrites:h}]=o,c=(0,_addlocale.addLocale)(i.pathname,i.locale);if((0,_isdynamic.isDynamicRoute)(c)||!s&&n.includes((0,_normalizelocalepath.normalizeLocalePath)((0,_removebasepath.removeBasePath)(c),a.router.locales).pathname)){const a=(0,_getnextpathnameinfo.getNextPathnameInfo)((0,_parserelativeurl.parseRelativeUrl)(e).pathname,{nextConfig:process.env.__NEXT_HAS_REWRITES?void 0:r,parseData:!0});c=(0,_addbasepath.addBasePath)(a.pathname),t.pathname=c}if(process.env.__NEXT_HAS_REWRITES){const e=(0,_resolverewrites.default)(c,n,h,t.query,(e=>resolveDynamicRoute(e,n)),a.router.locales);e.matchedPage&&(t.pathname=e.parsedAs.pathname,c=t.pathname,Object.assign(t.query,e.parsedAs.query))}else if(!n.includes(l)){const e=resolveDynamicRoute(l,n);e!==l&&(l=e)}const d=n.includes(l)?l:resolveDynamicRoute((0,_normalizelocalepath.normalizeLocalePath)((0,_removebasepath.removeBasePath)(t.pathname),a.router.locales).pathname,n);if((0,_isdynamic.isDynamicRoute)(d)){const e=(0,_routematcher.getRouteMatcher)((0,_routeregex.getRouteRegex)(d))(c);Object.assign(t.query,e||{})}return{type:"rewrite",parsedAs:t,resolvedHref:d}}))}const t=(0,_parsepath.parsePath)(e),i=(0,_formatnextpathnameinfo.formatNextPathnameInfo)({...(0,_getnextpathnameinfo.getNextPathnameInfo)(t.pathname,{nextConfig:r,parseData:!0}),defaultLocale:a.router.defaultLocale,buildId:""});return Promise.resolve({type:"redirect-external",destination:""+i+t.query+t.hash})}const l=t.headers.get("x-nextjs-redirect");if(l){if(l.startsWith("/")){const e=(0,_parsepath.parsePath)(l),t=(0,_formatnextpathnameinfo.formatNextPathnameInfo)({...(0,_getnextpathnameinfo.getNextPathnameInfo)(e.pathname,{nextConfig:r,parseData:!0}),defaultLocale:a.router.defaultLocale,buildId:""});return Promise.resolve({type:"redirect-internal",newAs:""+t+e.query+e.hash,newUrl:""+t+e.query+e.hash})}return Promise.resolve({type:"redirect-external",destination:l})}return Promise.resolve({type:"next"})}async function withMiddlewareEffects(e){if(!await matchesMiddleware(e)||!e.fetchData)return null;const t=await e.fetchData(),a=await getMiddlewareData(t.dataHref,t.response,e);return{dataHref:t.dataHref,json:t.json,response:t.response,text:t.text,cacheKey:t.cacheKey,effect:a}}const manualScrollRestoration=process.env.__NEXT_SCROLL_RESTORATION&&"undefined"!=typeof window&&"scrollRestoration"in window.history&&!!function(){try{let e="__next";return sessionStorage.setItem(e,e),sessionStorage.removeItem(e),!0}catch(e){}}(),SSG_DATA_NOT_FOUND=Symbol("SSG_DATA_NOT_FOUND");function fetchRetry(e,t,a){return fetch(e,{credentials:"same-origin",method:a.method||"GET",headers:Object.assign({},a.headers,{"x-nextjs-data":"1"})}).then((r=>!r.ok&&t>1&&r.status>=500?fetchRetry(e,t-1,a):r))}function tryToParseAsJSON(e){try{return JSON.parse(e)}catch(e){return null}}function fetchNextData(e){let{dataHref:t,inflightCache:a,isPrefetch:r,hasMiddleware:s,isServerRender:o,parseJSON:i,persistCache:l,isBackground:n,unstable_skipClientCache:h}=e;const{href:c}=new URL(t,window.location.href),d=e=>{var n;return fetchRetry(t,o?3:1,{headers:Object.assign({},r?{purpose:"prefetch"}:{},r&&s?{"x-middleware-prefetch":"1"}:{},process.env.NEXT_DEPLOYMENT_ID?{"x-deployment-id":process.env.NEXT_DEPLOYMENT_ID}:{}),method:null!=(n=null==e?void 0:e.method)?n:"GET"}).then((a=>a.ok&&"HEAD"===(null==e?void 0:e.method)?{dataHref:t,response:a,text:"",json:{},cacheKey:c}:a.text().then((e=>{if(!a.ok){if(s&&[301,302,307,308].includes(a.status))return{dataHref:t,response:a,text:e,json:{},cacheKey:c};var r;if(404===a.status)if(null==(r=tryToParseAsJSON(e))?void 0:r.notFound)return{dataHref:t,json:{notFound:SSG_DATA_NOT_FOUND},response:a,text:e,cacheKey:c};const i=Object.defineProperty(new Error("Failed to load static props"),"__NEXT_ERROR_CODE",{value:"E124",enumerable:!1,configurable:!0});throw o||(0,_routeloader.markAssetError)(i),i}return{dataHref:t,json:i?tryToParseAsJSON(e):null,response:a,text:e,cacheKey:c}})))).then((e=>(l&&"production"===process.env.NODE_ENV&&"no-cache"!==e.response.headers.get("x-middleware-cache")||delete a[c],e))).catch((e=>{throw h||delete a[c],"Failed to fetch"!==e.message&&"NetworkError when attempting to fetch resource."!==e.message&&"Load failed"!==e.message||(0,_routeloader.markAssetError)(e),e}))};return h&&l?d({}).then((e=>("no-cache"!==e.response.headers.get("x-middleware-cache")&&(a[c]=Promise.resolve(e)),e))):void 0!==a[c]?a[c]:a[c]=d(n?{method:"HEAD"}:{})}function createKey(){return Math.random().toString(36).slice(2,10)}function handleHardNavigation(e){let{url:t,router:a}=e;if(t===(0,_addbasepath.addBasePath)((0,_addlocale.addLocale)(a.asPath,a.locale)))throw Object.defineProperty(new Error("Invariant: attempted to hard navigate to the same URL "+t+" "+location.href),"__NEXT_ERROR_CODE",{value:"E282",enumerable:!1,configurable:!0});window.location.href=t}const getCancelledHandler=e=>{let{route:t,router:a}=e,r=!1;const s=a.clc=()=>{r=!0};return()=>{if(r){const e=Object.defineProperty(new Error('Abort fetching component for route: "'+t+'"'),"__NEXT_ERROR_CODE",{value:"E483",enumerable:!1,configurable:!0});throw e.cancelled=!0,e}s===a.clc&&(a.clc=null)}};class Router{reload(){window.location.reload()}back(){window.history.back()}forward(){window.history.forward()}push(e,t,a){if(void 0===a&&(a={}),process.env.__NEXT_SCROLL_RESTORATION&&manualScrollRestoration)try{sessionStorage.setItem("__next_scroll_"+this._key,JSON.stringify({x:self.pageXOffset,y:self.pageYOffset}))}catch(e){}return({url:e,as:t}=prepareUrlAs(this,e,t)),this.change("pushState",e,t,a)}replace(e,t,a){return void 0===a&&(a={}),({url:e,as:t}=prepareUrlAs(this,e,t)),this.change("replaceState",e,t,a)}async _bfl(e,t,a,r){if(process.env.__NEXT_CLIENT_ROUTER_FILTER_ENABLED){if(!this._bfl_s&&!this._bfl_d){const{BloomFilter:t}=require("../../lib/bloom-filter");let s,o;try{({__routerFilterStatic:s,__routerFilterDynamic:o}=await(0,_routeloader.getClientBuildManifest)())}catch(t){return console.error(t),r?!0:(handleHardNavigation({url:(0,_addbasepath.addBasePath)((0,_addlocale.addLocale)(e,a||this.locale,this.defaultLocale)),router:this}),new Promise((()=>{})))}const i=process.env.__NEXT_CLIENT_ROUTER_S_FILTER;!s&&i&&(s=i||void 0);const l=process.env.__NEXT_CLIENT_ROUTER_D_FILTER;!o&&l&&(o=l||void 0),(null==s?void 0:s.numHashes)&&(this._bfl_s=new t(s.numItems,s.errorRate),this._bfl_s.import(s)),(null==o?void 0:o.numHashes)&&(this._bfl_d=new t(o.numItems,o.errorRate),this._bfl_d.import(o))}let l=!1,n=!1;const h=[{as:e},{as:t}];for(const{as:t,allowMatchCurrent:c}of h)if(t){const h=(0,_removetrailingslash.removeTrailingSlash)(new URL(t,"http://n").pathname),d=(0,_addbasepath.addBasePath)((0,_addlocale.addLocale)(h,a||this.locale));if(c||h!==(0,_removetrailingslash.removeTrailingSlash)(new URL(this.asPath,"http://n").pathname)){var s,o;l=l||!!(null==(s=this._bfl_s)?void 0:s.contains(h))||!!(null==(o=this._bfl_s)?void 0:o.contains(d));for(const e of[h,d]){const t=e.split("/");for(let e=0;!n&&e<t.length+1;e++){var i;const a=t.slice(0,e).join("/");if(a&&(null==(i=this._bfl_d)?void 0:i.contains(a))){n=!0;break}}}if(l||n)return!!r||(handleHardNavigation({url:(0,_addbasepath.addBasePath)((0,_addlocale.addLocale)(e,a||this.locale,this.defaultLocale)),router:this}),new Promise((()=>{})))}}}return!1}async change(e,t,a,r,s){var o;if(!(0,_islocalurl.isLocalURL)(t))return handleHardNavigation({url:t,router:this}),!1;const i=1===r._h;i||r.shallow||await this._bfl(a,void 0,r.locale);let l=i||r._shouldResolveHref||(0,_parsepath.parsePath)(t).pathname===(0,_parsepath.parsePath)(a).pathname;const n={...this.state},h=!0!==this.isReady;this.isReady=!0;const c=this.isSsr;if(i||(this.isSsr=!1),i&&this.clc)return!1;const d=n.locale;if(process.env.__NEXT_I18N_SUPPORT){n.locale=!1===r.locale?this.defaultLocale:r.locale||n.locale,void 0===r.locale&&(r.locale=n.locale);const e=(0,_parserelativeurl.parseRelativeUrl)((0,_hasbasepath.hasBasePath)(a)?(0,_removebasepath.removeBasePath)(a):a),s=(0,_normalizelocalepath.normalizeLocalePath)(e.pathname,this.locales);s.detectedLocale&&(n.locale=s.detectedLocale,e.pathname=(0,_addbasepath.addBasePath)(e.pathname),a=(0,_formaturl.formatWithValidation)(e),t=(0,_addbasepath.addBasePath)((0,_normalizelocalepath.normalizeLocalePath)((0,_hasbasepath.hasBasePath)(t)?(0,_removebasepath.removeBasePath)(t):t,this.locales).pathname));let o=!1;var _;if(process.env.__NEXT_I18N_SUPPORT)(null==(_=this.locales)?void 0:_.includes(n.locale))||(e.pathname=(0,_addlocale.addLocale)(e.pathname,n.locale),handleHardNavigation({url:(0,_formaturl.formatWithValidation)(e),router:this}),o=!0);const i=(0,_detectdomainlocale.detectDomainLocale)(this.domainLocales,void 0,n.locale);if(process.env.__NEXT_I18N_SUPPORT&&!o&&i&&this.isLocaleDomain&&self.location.hostname!==i.domain){const e=(0,_removebasepath.removeBasePath)(a);handleHardNavigation({url:"http"+(i.http?"":"s")+"://"+i.domain+(0,_addbasepath.addBasePath)((n.locale===i.defaultLocale?"":"/"+n.locale)+("/"===e?"":e)||"/"),router:this}),o=!0}if(o)return new Promise((()=>{}))}_utils.ST&&performance.mark("routeChange");const{shallow:p=!1,scroll:u=!0}=r,m={shallow:p};this._inFlightRoute&&this.clc&&(c||Router.events.emit("routeChangeError",buildCancellationError(),this._inFlightRoute,m),this.clc(),this.clc=null),a=(0,_addbasepath.addBasePath)((0,_addlocale.addLocale)((0,_hasbasepath.hasBasePath)(a)?(0,_removebasepath.removeBasePath)(a):a,r.locale,this.defaultLocale));const f=(0,_removelocale.removeLocale)((0,_hasbasepath.hasBasePath)(a)?(0,_removebasepath.removeBasePath)(a):a,n.locale);this._inFlightRoute=a;const v=d!==n.locale;if(!i&&this.onlyAHashChange(f)&&!v){n.asPath=f,Router.events.emit("hashChangeStart",a,m),this.changeState(e,t,a,{...r,scroll:!1}),u&&this.scrollToHash(f);try{await this.set(n,this.components[n.route],null)}catch(e){throw(0,_iserror.default)(e)&&e.cancelled&&Router.events.emit("routeChangeError",e,f,m),e}return Router.events.emit("hashChangeComplete",a,m),!0}let g,P,w=(0,_parserelativeurl.parseRelativeUrl)(t),{pathname:E,query:R}=w;try{[g,{__rewrites:P}]=await Promise.all([this.pageLoader.getPageList(),(0,_routeloader.getClientBuildManifest)(),this.pageLoader.getMiddleware()])}catch(e){return handleHardNavigation({url:a,router:this}),!1}this.urlIsNew(f)||v||(e="replaceState");let y=a;E=E?(0,_removetrailingslash.removeTrailingSlash)((0,_removebasepath.removeBasePath)(E)):E;let b=(0,_removetrailingslash.removeTrailingSlash)(E);const N=a.startsWith("/")&&(0,_parserelativeurl.parseRelativeUrl)(a).pathname;if(null==(o=this.components[E])?void 0:o.__appRouter)return handleHardNavigation({url:a,router:this}),new Promise((()=>{}));const S=!(!N||b===N||(0,_isdynamic.isDynamicRoute)(b)&&(0,_routematcher.getRouteMatcher)((0,_routeregex.getRouteRegex)(b))(N)),T=!r.shallow&&await matchesMiddleware({asPath:a,locale:n.locale,router:this});if(i&&T&&(l=!1),l&&"/_error"!==E)if(r._shouldResolveHref=!0,process.env.__NEXT_HAS_REWRITES&&a.startsWith("/")){const e=(0,_resolverewrites.default)((0,_addbasepath.addBasePath)((0,_addlocale.addLocale)(f,n.locale),!0),g,P,R,(e=>resolveDynamicRoute(e,g)),this.locales);if(e.externalDest)return handleHardNavigation({url:a,router:this}),!0;T||(y=e.asPath),e.matchedPage&&e.resolvedHref&&(E=e.resolvedHref,w.pathname=(0,_addbasepath.addBasePath)(E),T||(t=(0,_formaturl.formatWithValidation)(w)))}else w.pathname=resolveDynamicRoute(E,g),w.pathname!==E&&(E=w.pathname,w.pathname=(0,_addbasepath.addBasePath)(E),T||(t=(0,_formaturl.formatWithValidation)(w)));if(!(0,_islocalurl.isLocalURL)(a)){if("production"!==process.env.NODE_ENV)throw Object.defineProperty(new Error('Invalid href: "'+t+'" and as: "'+a+'", received relative href and external as\nSee more info: https://nextjs.org/docs/messages/invalid-relative-url-external-as'),"__NEXT_ERROR_CODE",{value:"E380",enumerable:!1,configurable:!0});return handleHardNavigation({url:a,router:this}),!1}y=(0,_removelocale.removeLocale)((0,_removebasepath.removeBasePath)(y),n.locale),b=(0,_removetrailingslash.removeTrailingSlash)(E);let O=!1;if((0,_isdynamic.isDynamicRoute)(b)){const e=(0,_parserelativeurl.parseRelativeUrl)(y),r=e.pathname,s=(0,_routeregex.getRouteRegex)(b);O=(0,_routematcher.getRouteMatcher)(s)(r);const o=b===r,i=o?(0,_interpolateas.interpolateAs)(b,r,R):{};if(!O||o&&!i.result){const e=Object.keys(s.groups).filter((e=>!R[e]&&!s.groups[e].optional));if(e.length>0&&!T)throw"production"!==process.env.NODE_ENV&&console.warn((o?"Interpolating href":"Mismatching `as` and `href`")+" failed to manually provide the params: "+e.join(", ")+" in the `href`'s `query`"),Object.defineProperty(new Error((o?"The provided `href` ("+t+") value is missing query values ("+e.join(", ")+") to be interpolated properly. ":"The provided `as` value ("+r+") is incompatible with the `href` value ("+b+"). ")+"Read more: https://nextjs.org/docs/messages/"+(o?"href-interpolation-failed":"incompatible-href-as")),"__NEXT_ERROR_CODE",{value:"E344",enumerable:!1,configurable:!0})}else o?a=(0,_formaturl.formatWithValidation)(Object.assign({},e,{pathname:i.result,query:(0,_omit.omit)(R,i.params)})):Object.assign(R,O)}i||Router.events.emit("routeChangeStart",a,m);const L="/404"===this.pathname||"/_error"===this.pathname;try{var C,D,A;let o=await this.getRouteInfo({route:b,pathname:E,query:R,as:a,resolvedAs:y,routeProps:m,locale:n.locale,isPreview:n.isPreview,hasMiddleware:T,unstable_skipClientCache:r.unstable_skipClientCache,isQueryUpdating:i&&!this.isFallback,isMiddlewareRewrite:S});if(i||r.shallow||await this._bfl(a,"resolvedAs"in o?o.resolvedAs:void 0,n.locale),"route"in o&&T){E=o.route||b,b=E,m.shallow||(R=Object.assign({},o.query||{},R));const e=(0,_hasbasepath.hasBasePath)(w.pathname)?(0,_removebasepath.removeBasePath)(w.pathname):w.pathname;if(O&&E!==e&&Object.keys(O).forEach((e=>{O&&R[e]===O[e]&&delete R[e]})),(0,_isdynamic.isDynamicRoute)(E)){let e=!m.shallow&&o.resolvedAs?o.resolvedAs:(0,_addbasepath.addBasePath)((0,_addlocale.addLocale)(new URL(a,location.href).pathname,n.locale),!0);if((0,_hasbasepath.hasBasePath)(e)&&(e=(0,_removebasepath.removeBasePath)(e)),process.env.__NEXT_I18N_SUPPORT){const t=(0,_normalizelocalepath.normalizeLocalePath)(e,this.locales);n.locale=t.detectedLocale||n.locale,e=t.pathname}const t=(0,_routeregex.getRouteRegex)(E),r=(0,_routematcher.getRouteMatcher)(t)(new URL(e,location.href).pathname);r&&Object.assign(R,r)}}if("type"in o)return"redirect-internal"===o.type?this.change(e,o.newUrl,o.newAs,r):(handleHardNavigation({url:o.destination,router:this}),new Promise((()=>{})));const l=o.Component;if(l&&l.unstable_scriptLoader){[].concat(l.unstable_scriptLoader()).forEach((e=>{(0,_script.handleClientScriptLoad)(e.props)}))}if((o.__N_SSG||o.__N_SSP)&&o.props){if(o.props.pageProps&&o.props.pageProps.__N_REDIRECT){r.locale=!1;const t=o.props.pageProps.__N_REDIRECT;if(t.startsWith("/")&&!1!==o.props.pageProps.__N_REDIRECT_BASE_PATH){const a=(0,_parserelativeurl.parseRelativeUrl)(t);a.pathname=resolveDynamicRoute(a.pathname,g);const{url:s,as:o}=prepareUrlAs(this,t,t);return this.change(e,s,o,r)}return handleHardNavigation({url:t,router:this}),new Promise((()=>{}))}if(n.isPreview=!!o.props.__N_PREVIEW,o.props.notFound===SSG_DATA_NOT_FOUND){let e;try{await this.fetchComponent("/404"),e="/404"}catch(t){e="/_error"}if(o=await this.getRouteInfo({route:e,pathname:e,query:R,as:a,resolvedAs:y,routeProps:{shallow:!1},locale:n.locale,isPreview:n.isPreview,isNotFound:!0}),"type"in o)throw Object.defineProperty(new Error("Unexpected middleware effect on /404"),"__NEXT_ERROR_CODE",{value:"E158",enumerable:!1,configurable:!0})}}var x;i&&"/_error"===this.pathname&&500===(null==(D=self.__NEXT_DATA__.props)||null==(C=D.pageProps)?void 0:C.statusCode)&&(null==(A=o.props)?void 0:A.pageProps)&&(o.props.pageProps.statusCode=500);const c=r.shallow&&n.route===(null!=(x=o.route)?x:b);var H;const d=null!=(H=r.scroll)?H:!i&&!c,_=null!=s?s:d?{x:0,y:0}:null,p={...n,route:b,pathname:E,query:R,asPath:f,isFallback:!1};if(i&&L){var I,q,B;if(o=await this.getRouteInfo({route:this.pathname,pathname:this.pathname,query:R,as:a,resolvedAs:y,routeProps:{shallow:!1},locale:n.locale,isPreview:n.isPreview,isQueryUpdating:i&&!this.isFallback}),"type"in o)throw Object.defineProperty(new Error("Unexpected middleware effect on "+this.pathname),"__NEXT_ERROR_CODE",{value:"E225",enumerable:!1,configurable:!0});"/_error"===this.pathname&&500===(null==(q=self.__NEXT_DATA__.props)||null==(I=q.pageProps)?void 0:I.statusCode)&&(null==(B=o.props)?void 0:B.pageProps)&&(o.props.pageProps.statusCode=500);try{await this.set(p,o,_)}catch(e){throw(0,_iserror.default)(e)&&e.cancelled&&Router.events.emit("routeChangeError",e,f,m),e}return!0}Router.events.emit("beforeHistoryChange",a,m),this.changeState(e,t,a,r);if(!(i&&!_&&!h&&!v&&(0,_comparestates.compareRouterStates)(p,this.state))){try{await this.set(p,o,_)}catch(e){if(!e.cancelled)throw e;o.error=o.error||e}if(o.error)throw i||Router.events.emit("routeChangeError",o.error,f,m),o.error;process.env.__NEXT_I18N_SUPPORT&&n.locale&&(document.documentElement.lang=n.locale),i||Router.events.emit("routeChangeComplete",a,m);d&&/#.+$/.test(a)&&this.scrollToHash(a)}return!0}catch(e){if((0,_iserror.default)(e)&&e.cancelled)return!1;throw e}}changeState(e,t,a,r){if(void 0===r&&(r={}),"production"!==process.env.NODE_ENV){if(void 0===window.history)return void console.error("Warning: window.history is not available.");if(void 0===window.history[e])return void console.error("Warning: window.history."+e+" is not available")}"pushState"===e&&(0,_utils.getURL)()===a||(this._shallow=r.shallow,window.history[e]({url:t,as:a,options:r,__N:!0,key:this._key="pushState"!==e?this._key:createKey()},"",a))}async handleRouteInfoError(e,t,a,r,s,o){if(e.cancelled)throw e;if((0,_routeloader.isAssetError)(e)||o)throw Router.events.emit("routeChangeError",e,r,s),handleHardNavigation({url:r,router:this}),buildCancellationError();console.error(e);try{let r;const{page:s,styleSheets:o}=await this.fetchComponent("/_error"),i={props:r,Component:s,styleSheets:o,err:e,error:e};if(!i.props)try{i.props=await this.getInitialProps(s,{err:e,pathname:t,query:a})}catch(e){console.error("Error in error page `getInitialProps`: ",e),i.props={}}return i}catch(e){return this.handleRouteInfoError((0,_iserror.default)(e)?e:Object.defineProperty(new Error(e+""),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0}),t,a,r,s,!0)}}async getRouteInfo(e){let{route:t,pathname:a,query:r,as:s,resolvedAs:o,routeProps:i,locale:l,hasMiddleware:n,isPreview:h,unstable_skipClientCache:c,isQueryUpdating:d,isMiddlewareRewrite:_,isNotFound:p}=e,u=t;try{var m,f,v,g;let e=this.components[u];if(i.shallow&&e&&this.route===u)return e;const t=getCancelledHandler({route:u,router:this});n&&(e=void 0);let P=e&&!("initial"in e)&&"development"!==process.env.NODE_ENV?e:void 0;const w=d,E={dataHref:this.pageLoader.getDataHref({href:(0,_formaturl.formatWithValidation)({pathname:a,query:r}),skipInterpolation:!0,asPath:p?"/404":o,locale:l}),hasMiddleware:!0,isServerRender:this.isSsr,parseJSON:!0,inflightCache:w?this.sbc:this.sdc,persistCache:!h,isPrefetch:!1,unstable_skipClientCache:c,isBackground:w};let R=d&&!_?null:await withMiddlewareEffects({fetchData:()=>fetchNextData(E),asPath:p?"/404":o,locale:l,router:this}).catch((e=>{if(d)return null;throw e}));if(!R||"/_error"!==a&&"/404"!==a||(R.effect=void 0),d&&(R?R.json=self.__NEXT_DATA__.props:R={json:self.__NEXT_DATA__.props}),t(),"redirect-internal"===(null==R||null==(m=R.effect)?void 0:m.type)||"redirect-external"===(null==R||null==(f=R.effect)?void 0:f.type))return R.effect;if("rewrite"===(null==R||null==(v=R.effect)?void 0:v.type)){const t=(0,_removetrailingslash.removeTrailingSlash)(R.effect.resolvedHref),s=await this.pageLoader.getPageList();if((!d||s.includes(t))&&(u=t,a=R.effect.resolvedHref,r={...r,...R.effect.parsedAs.query},o=(0,_removebasepath.removeBasePath)((0,_normalizelocalepath.normalizeLocalePath)(R.effect.parsedAs.pathname,this.locales).pathname),e=this.components[u],i.shallow&&e&&this.route===u&&!n))return{...e,route:u}}if((0,_isapiroute.isAPIRoute)(u))return handleHardNavigation({url:s,router:this}),new Promise((()=>{}));const y=P||await this.fetchComponent(u).then((e=>({Component:e.page,styleSheets:e.styleSheets,__N_SSG:e.mod.__N_SSG,__N_SSP:e.mod.__N_SSP})));if("production"!==process.env.NODE_ENV){const{isValidElementType:e}=require("next/dist/compiled/react-is");if(!e(y.Component))throw Object.defineProperty(new Error('The default export is not a React Component in page: "'+a+'"'),"__NEXT_ERROR_CODE",{value:"E286",enumerable:!1,configurable:!0})}const b=null==R||null==(g=R.response)?void 0:g.headers.get("x-middleware-skip"),N=y.__N_SSG||y.__N_SSP;b&&(null==R?void 0:R.dataHref)&&delete this.sdc[R.dataHref];const{props:S,cacheKey:T}=await this._getData((async()=>{if(N){if((null==R?void 0:R.json)&&!b)return{cacheKey:R.cacheKey,props:R.json};const e=(null==R?void 0:R.dataHref)?R.dataHref:this.pageLoader.getDataHref({href:(0,_formaturl.formatWithValidation)({pathname:a,query:r}),asPath:o,locale:l}),t=await fetchNextData({dataHref:e,isServerRender:this.isSsr,parseJSON:!0,inflightCache:b?{}:this.sdc,persistCache:!h,isPrefetch:!1,unstable_skipClientCache:c});return{cacheKey:t.cacheKey,props:t.json||{}}}return{headers:{},props:await this.getInitialProps(y.Component,{pathname:a,query:r,asPath:s,locale:l,locales:this.locales,defaultLocale:this.defaultLocale})}}));return y.__N_SSP&&E.dataHref&&T&&delete this.sdc[T],this.isPreview||!y.__N_SSG||"development"===process.env.NODE_ENV||d||fetchNextData(Object.assign({},E,{isBackground:!0,persistCache:!1,inflightCache:this.sbc})).catch((()=>{})),S.pageProps=Object.assign({},S.pageProps),y.props=S,y.route=u,y.query=r,y.resolvedAs=o,this.components[u]=y,y}catch(e){return this.handleRouteInfoError((0,_iserror.getProperError)(e),a,r,s,i)}}set(e,t,a){return this.state=e,this.sub(t,this.components["/_app"].Component,a)}beforePopState(e){this._bps=e}onlyAHashChange(e){if(!this.asPath)return!1;const[t,a]=this.asPath.split("#",2),[r,s]=e.split("#",2);return!(!s||t!==r||a!==s)||t===r&&a!==s}scrollToHash(e){const[,t=""]=e.split("#",2);(0,_handlesmoothscroll.handleSmoothScroll)((()=>{if(""===t||"top"===t)return void window.scrollTo(0,0);const e=decodeURIComponent(t),a=document.getElementById(e);if(a)return void a.scrollIntoView();const r=document.getElementsByName(e)[0];r&&r.scrollIntoView()}),{onlyHashChange:this.onlyAHashChange(e)})}urlIsNew(e){return this.asPath!==e}async prefetch(e,t,a){if(void 0===t&&(t=e),void 0===a&&(a={}),"production"!==process.env.NODE_ENV)return;if("undefined"!=typeof window&&(0,_isbot.isBot)(window.navigator.userAgent))return;let r=(0,_parserelativeurl.parseRelativeUrl)(e);const s=r.pathname;let{pathname:o,query:i}=r;const l=o;if(process.env.__NEXT_I18N_SUPPORT&&!1===a.locale){o=(0,_normalizelocalepath.normalizeLocalePath)(o,this.locales).pathname,r.pathname=o,e=(0,_formaturl.formatWithValidation)(r);let s=(0,_parserelativeurl.parseRelativeUrl)(t);const i=(0,_normalizelocalepath.normalizeLocalePath)(s.pathname,this.locales);s.pathname=i.pathname,a.locale=i.detectedLocale||this.defaultLocale,t=(0,_formaturl.formatWithValidation)(s)}const n=await this.pageLoader.getPageList();let h=t;const c=void 0!==a.locale?a.locale||void 0:this.locale,d=await matchesMiddleware({asPath:t,locale:c,router:this});if(process.env.__NEXT_HAS_REWRITES&&t.startsWith("/")){let a;({__rewrites:a}=await(0,_routeloader.getClientBuildManifest)());const s=(0,_resolverewrites.default)((0,_addbasepath.addBasePath)((0,_addlocale.addLocale)(t,this.locale),!0),n,a,r.query,(e=>resolveDynamicRoute(e,n)),this.locales);if(s.externalDest)return;d||(h=(0,_removelocale.removeLocale)((0,_removebasepath.removeBasePath)(s.asPath),this.locale)),s.matchedPage&&s.resolvedHref&&(o=s.resolvedHref,r.pathname=o,d||(e=(0,_formaturl.formatWithValidation)(r)))}r.pathname=resolveDynamicRoute(r.pathname,n),(0,_isdynamic.isDynamicRoute)(r.pathname)&&(o=r.pathname,r.pathname=o,Object.assign(i,(0,_routematcher.getRouteMatcher)((0,_routeregex.getRouteRegex)(r.pathname))((0,_parsepath.parsePath)(t).pathname)||{}),d||(e=(0,_formaturl.formatWithValidation)(r)));const _="strict"===process.env.__NEXT_MIDDLEWARE_PREFETCH?null:await withMiddlewareEffects({fetchData:()=>fetchNextData({dataHref:this.pageLoader.getDataHref({href:(0,_formaturl.formatWithValidation)({pathname:l,query:i}),skipInterpolation:!0,asPath:h,locale:c}),hasMiddleware:!0,isServerRender:!1,parseJSON:!0,inflightCache:this.sdc,persistCache:!this.isPreview,isPrefetch:!0}),asPath:t,locale:c,router:this});if("rewrite"===(null==_?void 0:_.effect.type)&&(r.pathname=_.effect.resolvedHref,o=_.effect.resolvedHref,i={...i,..._.effect.parsedAs.query},h=_.effect.parsedAs.pathname,e=(0,_formaturl.formatWithValidation)(r)),"redirect-external"===(null==_?void 0:_.effect.type))return;const p=(0,_removetrailingslash.removeTrailingSlash)(o);await this._bfl(t,h,a.locale,!0)&&(this.components[s]={__appRouter:!0}),await Promise.all([this.pageLoader._isSsg(p).then((t=>!!t&&fetchNextData({dataHref:(null==_?void 0:_.json)?null==_?void 0:_.dataHref:this.pageLoader.getDataHref({href:e,asPath:h,locale:c}),isServerRender:!1,parseJSON:!0,inflightCache:this.sdc,persistCache:!this.isPreview,isPrefetch:!0,unstable_skipClientCache:a.unstable_skipClientCache||a.priority&&!!process.env.__NEXT_OPTIMISTIC_CLIENT_CACHE}).then((()=>!1)).catch((()=>!1)))),this.pageLoader[a.priority?"loadPage":"prefetch"](p)])}async fetchComponent(e){const t=getCancelledHandler({route:e,router:this});try{const a=await this.pageLoader.loadPage(e);return t(),a}catch(e){throw t(),e}}_getData(e){let t=!1;const a=()=>{t=!0};return this.clc=a,e().then((e=>{if(a===this.clc&&(this.clc=null),t){const e=Object.defineProperty(new Error("Loading initial props cancelled"),"__NEXT_ERROR_CODE",{value:"E405",enumerable:!1,configurable:!0});throw e.cancelled=!0,e}return e}))}getInitialProps(e,t){const{Component:a}=this.components["/_app"],r=this._wrapApp(a);return t.AppTree=r,(0,_utils.loadGetInitialProps)(a,{AppTree:r,Component:e,router:this,ctx:t})}get route(){return this.state.route}get pathname(){return this.state.pathname}get query(){return this.state.query}get asPath(){return this.state.asPath}get locale(){return this.state.locale}get isFallback(){return this.state.isFallback}get isPreview(){return this.state.isPreview}constructor(e,t,a,{initialProps:r,pageLoader:s,App:o,wrapApp:i,Component:l,err:n,subscription:h,isFallback:c,locale:d,locales:_,defaultLocale:p,domainLocales:u,isPreview:m}){this.sdc={},this.sbc={},this.isFirstPopStateEvent=!0,this._key=createKey(),this.onPopState=e=>{const{isFirstPopStateEvent:t}=this;this.isFirstPopStateEvent=!1;const a=e.state;if(!a){const{pathname:e,query:t}=this;return void this.changeState("replaceState",(0,_formaturl.formatWithValidation)({pathname:(0,_addbasepath.addBasePath)(e),query:t}),(0,_utils.getURL)())}if(a.__NA)return void window.location.reload();if(!a.__N)return;if(t&&this.locale===a.options.locale&&a.as===this.asPath)return;let r;const{url:s,as:o,options:i,key:l}=a;if(process.env.__NEXT_SCROLL_RESTORATION&&manualScrollRestoration&&this._key!==l){try{sessionStorage.setItem("__next_scroll_"+this._key,JSON.stringify({x:self.pageXOffset,y:self.pageYOffset}))}catch(e){}try{const e=sessionStorage.getItem("__next_scroll_"+l);r=JSON.parse(e)}catch(e){r={x:0,y:0}}}this._key=l;const{pathname:n}=(0,_parserelativeurl.parseRelativeUrl)(s);this.isSsr&&o===(0,_addbasepath.addBasePath)(this.asPath)&&n===(0,_addbasepath.addBasePath)(this.pathname)||this._bps&&!this._bps(a)||this.change("replaceState",s,o,Object.assign({},i,{shallow:i.shallow&&this._shallow,locale:i.locale||this.defaultLocale,_h:0}),r)};const f=(0,_removetrailingslash.removeTrailingSlash)(e);this.components={},"/_error"!==e&&(this.components[f]={Component:l,initial:!0,props:r,err:n,__N_SSG:r&&r.__N_SSG,__N_SSP:r&&r.__N_SSP}),this.components["/_app"]={Component:o,styleSheets:[]},this.events=Router.events,this.pageLoader=s;const v=(0,_isdynamic.isDynamicRoute)(e)&&self.__NEXT_DATA__.autoExport;if(this.basePath=process.env.__NEXT_ROUTER_BASEPATH||"",this.sub=h,this.clc=null,this._wrapApp=i,this.isSsr=!0,this.isLocaleDomain=!1,this.isReady=!(!(self.__NEXT_DATA__.gssp||self.__NEXT_DATA__.gip||self.__NEXT_DATA__.isExperimentalCompile||self.__NEXT_DATA__.appGip&&!self.__NEXT_DATA__.gsp)&&(v||self.location.search||process.env.__NEXT_HAS_REWRITES)),process.env.__NEXT_I18N_SUPPORT&&(this.locales=_,this.defaultLocale=p,this.domainLocales=u,this.isLocaleDomain=!!(0,_detectdomainlocale.detectDomainLocale)(u,self.location.hostname)),this.state={route:f,pathname:e,query:t,asPath:v?e:a,isPreview:!!m,locale:process.env.__NEXT_I18N_SUPPORT?d:void 0,isFallback:c},this._initialMatchesMiddlewarePromise=Promise.resolve(!1),"undefined"!=typeof window){if(!a.startsWith("//")){const r={locale:d},s=(0,_utils.getURL)();this._initialMatchesMiddlewarePromise=matchesMiddleware({router:this,locale:d,asPath:s}).then((o=>(r._shouldResolveHref=a!==e,this.changeState("replaceState",o?s:(0,_formaturl.formatWithValidation)({pathname:(0,_addbasepath.addBasePath)(e),query:t}),s,r),o)))}window.addEventListener("popstate",this.onPopState),process.env.__NEXT_SCROLL_RESTORATION&&manualScrollRestoration&&(window.history.scrollRestoration="manual")}}}Router.events=(0,_mitt.default)();