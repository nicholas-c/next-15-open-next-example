"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"postProcessHTML",{enumerable:!0,get:function(){return postProcessHTML}});const _nonnullable=require("../lib/non-nullable");async function postProcessHTML(e,n,r,{inAmpMode:t,hybridAmp:o}){const s=["edge"!==process.env.NEXT_RUNTIME&&t?async n=>{const t=require("./optimize-amp").default;return n=await t(n,r.ampOptimizerConfig),!r.ampSkipValidation&&r.ampValidator&&await r.ampValidator(n,e),n}:null,"edge"!==process.env.NEXT_RUNTIME&&r.optimizeCss?async e=>{const n=new(require("critters"))({ssrMode:!0,reduceInlineStyles:!1,path:r.distDir,publicPath:`${r.assetPrefix}/_next/`,preload:"media",fonts:!1,logLevel:process.env.CRITTERS_LOG_LEVEL||("production"===process.env.NODE_ENV?"warn":"info"),...r.optimizeCss});return await n.process(e)}:null,t||o?e=>e.replace(/&amp;amp=1/g,"&amp=1"):null].filter(_nonnullable.nonNullable);for(const e of s)e&&(n=await e(n));return n}