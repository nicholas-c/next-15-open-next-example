"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"default",{enumerable:!0,get:function(){return _default}});const _path=_interop_require_default(require("path")),_fs=_interop_require_default(require("fs")),_constant=require("../constant"),_utils=require("../utils");function _interop_require_default(e){return e&&e.__esModule?e:{default:e}}const entry={getCompletionsAtPosition(e,t,i){var n;const s=(0,_utils.getTs)(),o=[],r=null==(n=t.parameters)?void 0:n[0];if(r&&(0,_utils.isPositionInsideNode)(i,r)){const t=null==r?void 0:r.name;if(t&&s.isObjectBindingPattern(t)){let n,a=[],l=[];if((0,_utils.isPageFile)(e))a=_constant.ALLOWED_PAGE_PROPS,l=_constant.ALLOWED_PAGE_PROPS,n="page";else{const t=_path.default.dirname(e),i=_fs.default.readdirSync(t,{withFileTypes:!0}),s=[];for(const e of i)e.isDirectory()&&e.name.startsWith("@")&&s.push(e.name.slice(1));a=_constant.ALLOWED_LAYOUT_PROPS.concat(s),l=_constant.ALLOWED_LAYOUT_PROPS.concat(s.map((e=>`${e}: React.ReactNode`))),n="layout"}for(const e of t.elements)if((0,_utils.isPositionInsideNode)(i,e)){const t=e.propertyName||e.name;if((0,_utils.isPositionInsideNode)(i,t))for(const e of a)o.push({name:e,insertText:e,sortText:"_"+e,kind:s.ScriptElementKind.memberVariableElement,kindModifiers:s.ScriptElementKindModifier.none,labelDetails:{description:`Next.js ${n} prop`}});break}if(r.type&&s.isTypeLiteralNode(r.type))for(const e of r.type.members)if((0,_utils.isPositionInsideNode)(i,e)){for(const e of l)o.push({name:e,insertText:e,sortText:"_"+e,kind:s.ScriptElementKind.memberVariableElement,kindModifiers:s.ScriptElementKindModifier.none,labelDetails:{description:`Next.js ${n} prop type`}});break}}}return o},getSemanticDiagnostics(e,t,i){var n,s;const o=(0,_utils.getTs)();let r,a=[];if((0,_utils.isPageFile)(e))a=_constant.ALLOWED_PAGE_PROPS,r="page";else{const t=_path.default.dirname(e),i=_fs.default.readdirSync(t,{withFileTypes:!0}),n=[];for(const e of i)e.isDirectory()&&e.name.startsWith("@")&&n.push(e.name.slice(1));a=_constant.ALLOWED_LAYOUT_PROPS.concat(n),r="layout"}const l=[],c=null==(s=i.parameters)||null==(n=s[0])?void 0:n.name;if(c&&o.isObjectBindingPattern(c))for(const e of c.elements){const i=(e.propertyName||e.name).getText();a.includes(i)||l.push({file:t,category:o.DiagnosticCategory.Error,code:_constant.NEXT_TS_ERRORS.INVALID_PAGE_PROP,messageText:`"${i}" is not a valid ${r} prop.`,start:e.getStart(),length:e.getWidth()})}return l}},_default=entry;