"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"DevPagesRouteMatcherProvider",{enumerable:!0,get:function(){return DevPagesRouteMatcherProvider}});const _pagesroutematcher=require("../../route-matchers/pages-route-matcher"),_routekind=require("../../route-kind"),_path=_interop_require_default(require("path")),_filecacheroutematcherprovider=require("./file-cache-route-matcher-provider"),_pages=require("../../normalizers/built/pages");function _interop_require_default(e){return e&&e.__esModule?e:{default:e}}class DevPagesRouteMatcherProvider extends _filecacheroutematcherprovider.FileCacheRouteMatcherProvider{constructor(e,r,t,i){super(e,t),this.pagesDir=e,this.extensions=r,this.localeNormalizer=i,this.expression=new RegExp(`\\.(?:${r.join("|")})$`),this.normalizers=new _pages.DevPagesNormalizers(e,r)}test(e){if(!this.expression.test(e))return!1;if(e.startsWith(_path.default.join(this.pagesDir,"/api/")))return!1;for(const r of this.extensions)if(e===_path.default.join(this.pagesDir,`api.${r}`))return!1;return!0}async transform(e){const r=[];for(const t of e){if(!this.test(t))continue;const e=this.normalizers.pathname.normalize(t),i=this.normalizers.page.normalize(t),a=this.normalizers.bundlePath.normalize(t);this.localeNormalizer?r.push(new _pagesroutematcher.PagesLocaleRouteMatcher({kind:_routekind.RouteKind.PAGES,pathname:e,page:i,bundlePath:a,filename:t,i18n:{}})):r.push(new _pagesroutematcher.PagesRouteMatcher({kind:_routekind.RouteKind.PAGES,pathname:e,page:i,bundlePath:a,filename:t}))}return r}}