"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"DevAppPageRouteMatcherProvider",{enumerable:!0,get:function(){return DevAppPageRouteMatcherProvider}});const _apppageroutematcher=require("../../route-matchers/app-page-route-matcher"),_routekind=require("../../route-kind"),_filecacheroutematcherprovider=require("./file-cache-route-matcher-provider"),_app=require("../../normalizers/built/app"),_normalizecatchallroutes=require("../../../build/normalize-catchall-routes");class DevAppPageRouteMatcherProvider extends _filecacheroutematcherprovider.FileCacheRouteMatcherProvider{constructor(e,r,t){super(e,t),this.normalizers=new _app.DevAppNormalizers(e,r),this.expression=new RegExp(`[/\\\\](page|default)\\.(?:${r.join("|")})$`)}async transform(e){const r=new Map,t=new Array;let a={};for(const o of e){if(!this.expression.test(o))continue;const e=this.normalizers.page.normalize(o);if(e.includes("/_"))continue;t.push(o);const n=this.normalizers.pathname.normalize(o),i=this.normalizers.bundlePath.normalize(o);r.set(o,{page:e,pathname:n,bundlePath:i}),n in a?a[n].push(e):a[n]=[e]}(0,_normalizecatchallroutes.normalizeCatchAllRoutes)(a),a=Object.fromEntries(Object.entries(a).map((([e,r])=>[e,r.sort()])));const o=[];for(const e of t){const t=r.get(e);if(!t)throw Object.defineProperty(new Error("Invariant: expected filename to exist in cache"),"__NEXT_ERROR_CODE",{value:"E190",enumerable:!1,configurable:!0});const{pathname:n,page:i,bundlePath:p}=t;o.push(new _apppageroutematcher.AppPageRouteMatcher({kind:_routekind.RouteKind.APP_PAGE,pathname:n,page:i,bundlePath:p,filename:e,appPaths:a[n]}))}return o}}