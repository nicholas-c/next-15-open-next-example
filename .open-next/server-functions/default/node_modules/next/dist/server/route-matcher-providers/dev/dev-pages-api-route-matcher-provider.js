"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"DevPagesAPIRouteMatcherProvider",{enumerable:!0,get:function(){return DevPagesAPIRouteMatcherProvider}});const _pagesapiroutematcher=require("../../route-matchers/pages-api-route-matcher"),_routekind=require("../../route-kind"),_path=_interop_require_default(require("path")),_filecacheroutematcherprovider=require("./file-cache-route-matcher-provider"),_pages=require("../../normalizers/built/pages");function _interop_require_default(e){return e&&e.__esModule?e:{default:e}}class DevPagesAPIRouteMatcherProvider extends _filecacheroutematcherprovider.FileCacheRouteMatcherProvider{constructor(e,r,t,i){super(e,t),this.pagesDir=e,this.extensions=r,this.localeNormalizer=i,this.expression=new RegExp(`\\.(?:${r.join("|")})$`),this.normalizers=new _pages.DevPagesNormalizers(e,r)}test(e){if(!this.expression.test(e))return!1;if(e.startsWith(_path.default.join(this.pagesDir,"/api/")))return!0;for(const r of this.extensions)if(e===_path.default.join(this.pagesDir,`api.${r}`))return!0;return!1}async transform(e){const r=[];for(const t of e){if(!this.test(t))continue;const e=this.normalizers.pathname.normalize(t),i=this.normalizers.page.normalize(t),a=this.normalizers.bundlePath.normalize(t);this.localeNormalizer?r.push(new _pagesapiroutematcher.PagesAPILocaleRouteMatcher({kind:_routekind.RouteKind.PAGES_API,pathname:e,page:i,bundlePath:a,filename:t,i18n:{}})):r.push(new _pagesapiroutematcher.PagesAPIRouteMatcher({kind:_routekind.RouteKind.PAGES_API,pathname:e,page:i,bundlePath:a,filename:t}))}return r}}