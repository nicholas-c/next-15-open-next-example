"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"sendResponse",{enumerable:!0,get:function(){return sendResponse}});const _helpers=require("./base-http/helpers"),_pipereadable=require("./pipe-readable"),_utils=require("./web/utils");async function sendResponse(e,s,t,o){if("edge"!==process.env.NEXT_RUNTIME&&(0,_helpers.isNodeNextResponse)(s)){var r;s.statusCode=t.status,s.statusMessage=t.statusText;const a=["set-cookie","www-authenticate","proxy-authenticate","vary"];null==(r=t.headers)||r.forEach(((e,t)=>{if("x-middleware-set-cookie"!==t.toLowerCase())if("set-cookie"===t.toLowerCase())for(const o of(0,_utils.splitCookiesString)(e))s.appendHeader(t,o);else{const o=void 0!==s.getHeader(t);!a.includes(t.toLowerCase())&&o||s.appendHeader(t,e)}}));const{originalResponse:i}=s;t.body&&"HEAD"!==e.method?await(0,_pipereadable.pipeToNodeResponse)(t.body,i,o):i.end()}}