"use strict";function _export(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}Object.defineProperty(exports,"__esModule",{value:!0}),_export(exports,{RESTART_EXIT_CODE:function(){return RESTART_EXIT_CODE},formatDebugAddress:function(){return formatDebugAddress},formatNodeOptions:function(){return formatNodeOptions},getFormattedDebugAddress:function(){return getFormattedDebugAddress},getFormattedNodeOptionsWithoutInspect:function(){return getFormattedNodeOptionsWithoutInspect},getMaxOldSpaceSize:function(){return getMaxOldSpaceSize},getNodeDebugType:function(){return getNodeDebugType},getParsedDebugAddress:function(){return getParsedDebugAddress},getParsedNodeOptionsWithoutInspect:function(){return getParsedNodeOptionsWithoutInspect},parseValidPositiveInteger:function(){return parseValidPositiveInteger},printAndExit:function(){return printAndExit},tokenizeArgs:function(){return tokenizeArgs}});const _nodeutil=require("node:util"),_commander=require("next/dist/compiled/commander");function printAndExit(e,t=1){return 0===t?console.log(e):console.error(e),process.exit(t)}const parseNodeArgs=e=>{const{values:t,tokens:n}=(0,_nodeutil.parseArgs)({args:e,strict:!1,tokens:!0});let r=null;for(let e=0;e<n.length;e++){const o=n[e];if("option-terminator"===o.kind)break;"option"!==o.kind?"positional"===o.kind?r&&(r.name in t&&"string"==typeof t[r.name]?t[r.name]+=` ${o.value}`:t[r.name]=o.value):r=null:r=void 0===o.value?o:null}return t},tokenizeArgs=e=>{let t=[],n=!1,r=!0;for(let o=0;o<e.length;o++){let s=e[o];if("\\"===s&&n){if(e.length===o+1)throw Object.defineProperty(new Error("Invalid escape character at the end."),"__NEXT_ERROR_CODE",{value:"E168",enumerable:!1,configurable:!0});s=e[++o]}else{if(" "===s&&!n){r=!0;continue}if('"'===s){n=!n;continue}}r?(t.push(s),r=!1):t[t.length-1]+=s}if(n)throw Object.defineProperty(new Error("Unterminated string"),"__NEXT_ERROR_CODE",{value:"E208",enumerable:!1,configurable:!0});return t},getNodeOptionsArgs=()=>process.env.NODE_OPTIONS?tokenizeArgs(process.env.NODE_OPTIONS):[],formatDebugAddress=({host:e,port:t})=>e?`${e}:${t}`:`${t}`,getParsedDebugAddress=()=>{const e=getNodeOptionsArgs();if(0===e.length)return{host:void 0,port:9229};const t=parseNodeArgs(e),n=t.inspect??t["inspect-brk"]??t.inspect_brk;if(!n||"string"!=typeof n)return{host:void 0,port:9229};if(n.includes(":")){const[e,t]=n.split(":");return{host:e,port:parseInt(t,10)}}return{host:void 0,port:parseInt(n,10)}},getFormattedDebugAddress=()=>formatDebugAddress(getParsedDebugAddress());function formatNodeOptions(e){return Object.entries(e).map((([e,t])=>!0===t?`--${e}`:t?`--${e}=${t.includes(" ")&&!t.startsWith('"')?JSON.stringify(t):t}`:null)).filter((e=>null!==e)).join(" ")}function getParsedNodeOptionsWithoutInspect(){const e=getNodeOptionsArgs();if(0===e.length)return{};const t=parseNodeArgs(e);return delete t.inspect,delete t["inspect-brk"],delete t.inspect_brk,t}function getFormattedNodeOptionsWithoutInspect(){const e=getParsedNodeOptionsWithoutInspect();return 0===Object.keys(e).length?"":formatNodeOptions(e)}function parseValidPositiveInteger(e){const t=parseInt(e,10);if(isNaN(t)||!isFinite(t)||t<0)throw new _commander.InvalidArgumentError(`'${e}' is not a non-negative number.`);return t}const RESTART_EXIT_CODE=77;function getNodeDebugType(){const e=[...process.execArgv,...getNodeOptionsArgs()];if(0===e.length)return;const t=parseNodeArgs(e);return t.inspect?"inspect":t["inspect-brk"]||t.inspect_brk?"inspect-brk":void 0}function getMaxOldSpaceSize(){const e=getNodeOptionsArgs();if(0===e.length)return;const t=parseNodeArgs(e),n=t["max-old-space-size"]||t.max_old_space_size;return n&&"string"==typeof n?parseInt(n,10):void 0}