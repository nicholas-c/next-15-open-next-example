"use strict";function _export(e,r){for(var t in r)Object.defineProperty(e,t,{enumerable:!0,get:r[t]})}Object.defineProperty(exports,"__esModule",{value:!0}),_export(exports,{clearManifestCache:function(){return clearManifestCache},evalManifest:function(){return evalManifest},loadManifest:function(){return loadManifest}});const _fs=require("fs"),_vm=require("vm"),_deepfreeze=require("../shared/lib/deep-freeze"),sharedCache=new Map;function loadManifest(e,r=!0,t=sharedCache){const n=r&&t.get(e);if(n)return n;let a=JSON.parse((0,_fs.readFileSync)(e,"utf8"));return r&&(a=(0,_deepfreeze.deepFreeze)(a)),r&&t.set(e,a),a}function evalManifest(e,r=!0,t=sharedCache){const n=r&&t.get(e);if(n)return n;const a=(0,_fs.readFileSync)(e,"utf8");if(0===a.length)throw Object.defineProperty(new Error("Manifest file is empty"),"__NEXT_ERROR_CODE",{value:"E328",enumerable:!1,configurable:!0});let f={};return(0,_vm.runInNewContext)(a,f),r&&(f=(0,_deepfreeze.deepFreeze)(f)),r&&t.set(e,f),f}function clearManifestCache(e,r=sharedCache){return r.delete(e)}