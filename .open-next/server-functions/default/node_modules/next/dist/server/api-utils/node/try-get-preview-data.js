"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"tryGetPreviewData",{enumerable:!0,get:function(){return tryGetPreviewData}});const _=require("../."),_index=require("../index"),_cookies=require("../../web/spec-extension/cookies"),_headers=require("../../web/spec-extension/adapters/headers");function tryGetPreviewData(e,r,t,i){var n,a;if(t&&(0,_.checkIsOnDemandRevalidate)(e,t).isOnDemandRevalidate)return!1;if(_index.SYMBOL_PREVIEW_DATA in e)return e[_index.SYMBOL_PREVIEW_DATA];const d=_headers.HeadersAdapter.from(e.headers),o=new _cookies.RequestCookies(d),u=null==(n=o.get(_index.COOKIE_NAME_PRERENDER_BYPASS))?void 0:n.value,c=null==(a=o.get(_index.COOKIE_NAME_PRERENDER_DATA))?void 0:a.value;if(u&&!c&&u===t.previewModeId){const r={};return Object.defineProperty(e,_index.SYMBOL_PREVIEW_DATA,{value:r,enumerable:!1}),r}if(!u&&!c)return!1;if(!u||!c)return i||(0,_index.clearPreviewData)(r),!1;if(u!==t.previewModeId)return i||(0,_index.clearPreviewData)(r),!1;let s;try{s=require("next/dist/compiled/jsonwebtoken").verify(c,t.previewModeSigningKey)}catch{return(0,_index.clearPreviewData)(r),!1}const{decryptWithSecret:l}=require("../../crypto-utils"),v=l(Buffer.from(t.previewModeEncryptionKey),s.data);try{const r=JSON.parse(v);return Object.defineProperty(e,_index.SYMBOL_PREVIEW_DATA,{value:r,enumerable:!1}),r}catch{return!1}}