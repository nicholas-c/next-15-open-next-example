"use strict";function _export(e,r){for(var t in r)Object.defineProperty(e,t,{enumerable:!0,get:r[t]})}Object.defineProperty(exports,"__esModule",{value:!0}),_export(exports,{renderToHTMLOrFlight:function(){return renderToHTMLOrFlight},warmFlightResponse:function(){return warmFlightResponse}});const _jsxruntime=require("react/jsx-runtime"),_workasyncstorageexternal=require("../app-render/work-async-storage.external"),_react=_interop_require_default(require("react")),_renderresult=_interop_require_default(require("../render-result")),_nodewebstreamshelper=require("../stream-utils/node-web-streams-helper"),_internalutils=require("../internal-utils"),_approuterheaders=require("../../client/components/app-router-headers"),_metadatacontext=require("../../lib/metadata/metadata-context"),_requeststore=require("../async-storage/request-store"),_workstore=require("../async-storage/work-store"),_httpaccessfallback=require("../../client/components/http-access-fallback/http-access-fallback"),_redirect=require("../../client/components/redirect"),_redirecterror=require("../../client/components/redirect-error"),_implicittags=require("../lib/implicit-tags"),_constants=require("../lib/trace/constants"),_tracer=require("../lib/trace/tracer"),_flightrenderresult=require("./flight-render-result"),_createerrorhandler=require("./create-error-handler"),_getshortdynamicparamtype=require("./get-short-dynamic-param-type"),_getsegmentparam=require("./get-segment-param"),_getscriptnoncefromheader=require("./get-script-nonce-from-header"),_parseandvalidateflightrouterstate=require("./parse-and-validate-flight-router-state"),_createflightrouterstatefromloadertree=require("./create-flight-router-state-from-loader-tree"),_actionhandler=require("./action-handler"),_bailouttocsr=require("../../shared/lib/lazy-dynamic/bailout-to-csr"),_log=require("../../build/output/log"),_requestcookies=require("../web/spec-extension/adapters/request-cookies"),_serverinsertedhtml=require("./server-inserted-html"),_requiredscripts=require("./required-scripts"),_addpathprefix=require("../../shared/lib/router/utils/add-path-prefix"),_makegetserverinsertedhtml=require("./make-get-server-inserted-html"),_walktreewithflightrouterstate=require("./walk-tree-with-flight-router-state"),_createcomponenttree=require("./create-component-tree"),_getassetquerystring=require("./get-asset-query-string"),_encryptionutils=require("./encryption-utils"),_postponedstate=require("./postponed-state"),_hooksservercontext=require("../../client/components/hooks-server-context"),_useflightresponse=require("./use-flight-response"),_staticgenerationbailout=require("../../client/components/static-generation-bailout"),_formatservererror=require("../../lib/format-server-error"),_dynamicrendering=require("./dynamic-rendering"),_clientcomponentrendererlogger=require("../client-component-renderer-logger"),_actionutils=require("./action-utils"),_helpers=require("../base-http/helpers"),_routeregex=require("../../shared/lib/router/utils/route-regex"),_parserelativeurl=require("../../shared/lib/router/utils/parse-relative-url"),_approuter=_interop_require_default(require("../../client/components/app-router")),_serveractionrequestmeta=require("../lib/server-action-request-meta"),_createinitialrouterstate=require("../../client/components/router-reducer/create-initial-router-state"),_actionqueue=require("../../shared/lib/router/action-queue"),_utils=require("../instrumentation/utils"),_segment=require("../../shared/lib/segment"),_apprenderprerenderutils=require("./app-render-prerender-utils"),_prospectiverenderutils=require("./prospective-render-utils"),_apprenderrenderutils=require("./app-render-render-utils"),_scheduler=require("../../lib/scheduler"),_workunitasyncstorageexternal=require("./work-unit-async-storage.external"),_cachesignal=require("./cache-signal"),_utils1=require("../lib/trace/utils"),_invarianterror=require("../../shared/lib/invariant-error");require("./clean-async-snapshot.external");const _constants1=require("../../lib/constants"),_createcomponentstylesandscripts=require("./create-component-styles-and-scripts"),_parseloadertree=require("./parse-loader-tree"),_resumedatacache=require("../resume-data-cache/resume-data-cache"),_iserror=_interop_require_default(require("../../lib/is-error")),_usecacheerrors=require("../use-cache/use-cache-errors"),_createserverinsertedmetadata=require("./metadata-insertion/create-server-inserted-metadata");function _interop_require_default(e){return e&&e.__esModule?e:{default:e}}const flightDataPathHeadKey="h";function parseRequestHeaders(e,r){const t=!0===r.isDevWarmup,a=t||void 0!==e[_approuterheaders.NEXT_ROUTER_PREFETCH_HEADER.toLowerCase()],n=void 0!==e[_approuterheaders.NEXT_HMR_REFRESH_HEADER.toLowerCase()],s=t||void 0!==e[_approuterheaders.RSC_HEADER.toLowerCase()],o=s&&(!a||!r.isRoutePPREnabled)?(0,_parseandvalidateflightrouterstate.parseAndValidateFlightRouterState)(e[_approuterheaders.NEXT_ROUTER_STATE_TREE_HEADER.toLowerCase()]):void 0,i="/_tree"===e[_approuterheaders.NEXT_ROUTER_SEGMENT_PREFETCH_HEADER.toLowerCase()],c=e["content-security-policy"]||e["content-security-policy-report-only"];return{flightRouterState:o,isPrefetchRequest:a,isRouteTreePrefetchRequest:i,isHmrRefresh:n,isRSCRequest:s,isDevWarmupRequest:t,nonce:"string"==typeof c?(0,_getscriptnoncefromheader.getScriptNonceFromHeader)(c):void 0}}function createNotFoundLoaderTree(e){const r=e[2];return["",{children:[_segment.PAGE_SEGMENT_KEY,{},{page:r["not-found"]}]},r]}function createDivergedMetadataComponents(e,r){function t(){return null}return{StaticMetadata:r?t:e,StreamingMetadata:r?e:null}}function makeGetDynamicParamFromSegment(e,r,t){return function(a){const n=(0,_getsegmentparam.getSegmentParam)(a);if(!n)return null;const s=n.param;let o=e[s];if(t&&t.has(n.param)?o=t.get(n.param):Array.isArray(o)?o=o.map((e=>encodeURIComponent(e))):"string"==typeof o&&(o=encodeURIComponent(o)),!o){const t="catchall"===n.type,a="optional-catchall"===n.type;if(t||a){const t=_getshortdynamicparamtype.dynamicParamTypes[n.type];return a?{param:s,value:null,type:t,treeSegment:[s,"",t]}:(o=r.split("/").slice(1).flatMap((r=>{const t=(0,_routeregex.parseParameter)(r);return e[t.key]??t.key})),{param:s,value:o,type:t,treeSegment:[s,o.join("/"),t]})}}const i=(0,_getshortdynamicparamtype.getShortDynamicParamType)(n.type);return{param:s,value:o,treeSegment:[s,Array.isArray(o)?o.join("/"):o,i],type:i}}}function NonIndex({ctx:e}){const r="/404"===e.pagePath,t="number"==typeof e.res.statusCode&&e.res.statusCode>400;return r||t?(0,_jsxruntime.jsx)("meta",{name:"robots",content:"noindex"}):null}function getServeStreamingMetadata(e){const r=!!e.renderOpts.experimental.isRoutePPREnabled,t=!!e.renderOpts.serveStreamingMetadata;return(!r||"true"===process.env.__NEXT_EXPERIMENTAL_PPR)&&t}async function generateDynamicRSCPayload(e,r){let t="";const{componentMod:{tree:a,createServerSearchParamsForMetadata:n,createServerParamsForMetadata:s,createMetadataComponents:o,MetadataBoundary:i,ViewportBoundary:c},getDynamicParamFromSegment:d,appUsingSizeAdjustment:l,query:u,requestId:p,flightRouterState:g,workStore:m,url:_}=e,S=getServeStreamingMetadata(e);if(!(null==r?void 0:r.skipFlight)){const r=[],h=n(u,m),{ViewportTree:v,MetadataTree:y,getViewportReady:E,getMetadataReady:f,StreamingMetadataOutlet:R}=o({tree:a,searchParams:h,metadataContext:(0,_metadatacontext.createTrackedMetadataContext)(_.pathname,e.renderOpts,m),getDynamicParamFromSegment:d,appUsingSizeAdjustment:l,createServerParamsForMetadata:s,workStore:m,MetadataBoundary:i,ViewportBoundary:c,serveStreamingMetadata:S}),{StreamingMetadata:w,StaticMetadata:I}=createDivergedMetadataComponents((()=>(0,_jsxruntime.jsx)(y,{},p)),S);t=(await(0,_walktreewithflightrouterstate.walkTreeWithFlightRouterState)({ctx:e,loaderTreeToFilter:a,parentParams:{},flightRouterState:g,rscHead:(0,_jsxruntime.jsxs)(_react.default.Fragment,{children:[(0,_jsxruntime.jsx)(NonIndex,{ctx:e}),(0,_jsxruntime.jsx)(v,{},p),(0,_jsxruntime.jsx)(I,{})]},flightDataPathHeadKey),injectedCSS:new Set,injectedJS:new Set,injectedFontPreloadTags:new Set,rootLayoutIncluded:!1,getViewportReady:E,getMetadataReady:f,preloadCallbacks:r,StreamingMetadata:w,StreamingMetadataOutlet:R})).map((e=>e.slice(1)))}return(null==r?void 0:r.actionResult)?{a:r.actionResult,f:t,b:e.sharedContext.buildId}:{b:e.sharedContext.buildId,f:t,S:m.isStaticGeneration}}function createErrorContext(e,r){return{routerKind:"App Router",routePath:e.pagePath,routeType:e.isAction?"action":"render",renderSource:r,revalidateReason:(0,_utils.getRevalidateReason)(e.workStore)}}async function generateDynamicFlightRenderResult(e,r,t,a){const n=r.renderOpts;function s(t){return null==n.onInstrumentationRequestError?void 0:n.onInstrumentationRequestError.call(n,t,e,createErrorContext(r,"react-server-components-payload"))}const o=(0,_createerrorhandler.createFlightReactServerErrorHandler)(!!n.dev,s),i=await _workunitasyncstorageexternal.workUnitAsyncStorage.run(t,generateDynamicRSCPayload,r,a);if(n.dev&&"development"===process.env.NODE_ENV&&n.experimental.dynamicIO){const[e,a]=createValidationOutlet();i._validation=a,spawnDynamicValidationInDev(e,r.componentMod.tree,r,!1,r.clientReferenceManifest,r.workStore.route,t)}const c=_workunitasyncstorageexternal.workUnitAsyncStorage.run(t,r.componentMod.renderToReadableStream,i,r.clientReferenceManifest.clientModules,{onError:o,temporaryReferences:null==a?void 0:a.temporaryReferences});return new _flightrenderresult.FlightRenderResult(c,{fetchMetrics:r.workStore.fetchMetrics})}async function warmupDevRender(e,r){const t=r.renderOpts;if(!t.dev)throw Object.defineProperty(new _invarianterror.InvariantError("generateDynamicFlightRenderResult should never be called in `next start` mode."),"__NEXT_ERROR_CODE",{value:"E523",enumerable:!1,configurable:!0});const a=(0,_createcomponenttree.getRootParams)(r.componentMod.tree,r.getDynamicParamFromSegment);function n(a){return null==t.onInstrumentationRequestError?void 0:t.onInstrumentationRequestError.call(t,a,e,createErrorContext(r,"react-server-components-payload"))}const s=(0,_createerrorhandler.createFlightReactServerErrorHandler)(!0,n),o=(0,_resumedatacache.createPrerenderResumeDataCache)(),i=new AbortController,c=new AbortController,d=new _cachesignal.CacheSignal,l={type:"prerender",phase:"render",rootParams:a,implicitTags:[],renderSignal:i.signal,controller:c,cacheSignal:d,dynamicTracking:null,revalidate:_constants1.INFINITE_CACHE,expire:_constants1.INFINITE_CACHE,stale:_constants1.INFINITE_CACHE,tags:[],prerenderResumeDataCache:o},u=await _workunitasyncstorageexternal.workUnitAsyncStorage.run(l,generateDynamicRSCPayload,r);return _workunitasyncstorageexternal.workUnitAsyncStorage.run(l,r.componentMod.renderToReadableStream,u,r.clientReferenceManifest.clientModules,{onError:s,signal:i.signal}),await d.cacheReady(),l.prerenderResumeDataCache=null,i.abort(),new _flightrenderresult.FlightRenderResult("",{fetchMetrics:r.workStore.fetchMetrics,devRenderResumeDataCache:(0,_resumedatacache.createRenderResumeDataCache)(o)})}function prepareInitialCanonicalUrl(e){return(e.pathname+e.search).split("/")}async function getRSCPayload(e,r,t){const a=new Set,n=new Set,s=new Set;let o;"development"===process.env.NODE_ENV&&(o=new Set);const{getDynamicParamFromSegment:i,query:c,appUsingSizeAdjustment:d,componentMod:{GlobalError:l,createServerSearchParamsForMetadata:u,createServerParamsForMetadata:p,createMetadataComponents:g,MetadataBoundary:m,ViewportBoundary:_},url:S,workStore:h}=r,v=(0,_createflightrouterstatefromloadertree.createFlightRouterStateFromLoaderTree)(e,i,c),y=getServeStreamingMetadata(r),E=u(c,h),{ViewportTree:f,MetadataTree:R,getViewportReady:w,getMetadataReady:I,StreamingMetadataOutlet:T}=g({tree:e,errorType:t?"not-found":void 0,searchParams:E,metadataContext:(0,_metadatacontext.createTrackedMetadataContext)(S.pathname,r.renderOpts,h),getDynamicParamFromSegment:i,appUsingSizeAdjustment:d,createServerParamsForMetadata:p,workStore:h,MetadataBoundary:m,ViewportBoundary:_,serveStreamingMetadata:y}),b=[],{StreamingMetadata:C,StaticMetadata:x}=createDivergedMetadataComponents((()=>(0,_jsxruntime.jsx)(R,{})),y),M=await(0,_createcomponenttree.createComponentTree)({ctx:r,loaderTree:e,parentParams:{},injectedCSS:a,injectedJS:n,injectedFontPreloadTags:s,rootLayoutIncluded:!1,getViewportReady:w,getMetadataReady:I,missingSlots:o,preloadCallbacks:b,authInterrupts:r.renderOpts.experimental.authInterrupts,StreamingMetadata:C,StreamingMetadataOutlet:T}),P=r.res.getHeader("vary"),D="string"==typeof P&&P.includes(_approuterheaders.NEXT_URL),A=(0,_jsxruntime.jsxs)(_react.default.Fragment,{children:[(0,_jsxruntime.jsx)(NonIndex,{ctx:r}),(0,_jsxruntime.jsx)(f,{},r.requestId),(0,_jsxruntime.jsx)(x,{})]},flightDataPathHeadKey),k=await getGlobalErrorStyles(e,r),N=h.isStaticGeneration&&!0===r.renderOpts.experimental.isRoutePPREnabled;return{P:(0,_jsxruntime.jsx)(Preloads,{preloadCallbacks:b}),b:r.sharedContext.buildId,p:r.assetPrefix,c:prepareInitialCanonicalUrl(S),i:!!D,f:[[v,M,A,N]],m:o,G:[l,k],s:"string"==typeof r.renderOpts.postponed,S:h.isStaticGeneration}}function Preloads({preloadCallbacks:e}){return e.forEach((e=>e())),null}async function getErrorRSCPayload(e,r,t,a){const{getDynamicParamFromSegment:n,query:s,appUsingSizeAdjustment:o,componentMod:{GlobalError:i,createServerSearchParamsForMetadata:c,createServerParamsForMetadata:d,createMetadataComponents:l,MetadataBoundary:u,ViewportBoundary:p},url:g,requestId:m,workStore:_}=r,S=getServeStreamingMetadata(r),h=c(s,_),{MetadataTree:v,ViewportTree:y}=l({tree:e,searchParams:h,metadataContext:(0,_metadatacontext.createMetadataContext)(g.pathname,r.renderOpts),errorType:a,getDynamicParamFromSegment:n,appUsingSizeAdjustment:o,createServerParamsForMetadata:d,workStore:_,MetadataBoundary:u,ViewportBoundary:p,serveStreamingMetadata:S}),{StreamingMetadata:E,StaticMetadata:f}=createDivergedMetadataComponents((()=>(0,_jsxruntime.jsx)(_react.default.Fragment,{children:(0,_jsxruntime.jsx)(v,{},m)},flightDataPathHeadKey)),S),R=(0,_jsxruntime.jsxs)(_react.default.Fragment,{children:[(0,_jsxruntime.jsx)(NonIndex,{ctx:r}),(0,_jsxruntime.jsx)(y,{},m),"development"===process.env.NODE_ENV&&(0,_jsxruntime.jsx)("meta",{name:"next-error",content:"not-found"}),(0,_jsxruntime.jsx)(f,{})]},flightDataPathHeadKey),w=(0,_createflightrouterstatefromloadertree.createFlightRouterStateFromLoaderTree)(e,n,s);let I;t&&(I=(0,_iserror.default)(t)?t:Object.defineProperty(new Error(t+""),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0}));const T=[w[0],(0,_jsxruntime.jsxs)("html",{id:"__next_error__",children:[(0,_jsxruntime.jsx)("head",{children:E?(0,_jsxruntime.jsx)(E,{}):null}),(0,_jsxruntime.jsx)("body",{children:"production"!==process.env.NODE_ENV&&I?(0,_jsxruntime.jsx)("template",{"data-next-error-message":I.message,"data-next-error-digest":"digest"in I?I.digest:"","data-next-error-stack":I.stack}):null})]}),{},null,!1],b=await getGlobalErrorStyles(e,r),C=_.isStaticGeneration&&!0===r.renderOpts.experimental.isRoutePPREnabled;return{b:r.sharedContext.buildId,p:r.assetPrefix,c:prepareInitialCanonicalUrl(g),m:void 0,i:!1,f:[[w,T,R,C]],G:[i,b],s:"string"==typeof r.renderOpts.postponed,S:_.isStaticGeneration}}function App({reactServerStream:e,preinitScripts:r,clientReferenceManifest:t,nonce:a,ServerInsertedHTMLProvider:n,ServerInsertedMetadataProvider:s}){r();const o=_react.default.use((0,_useflightresponse.useFlightStream)(e,t,a)),i=(0,_createinitialrouterstate.createInitialRouterState)({initialFlightData:o.f,initialCanonicalUrlParts:o.c,initialParallelRoutes:new Map,location:null,couldBeIntercepted:o.i,postponed:o.s,prerendered:o.S}),c=(0,_actionqueue.createMutableActionQueue)(i),{HeadManagerContext:d}=require("../../shared/lib/head-manager-context.shared-runtime");return(0,_jsxruntime.jsx)(d.Provider,{value:{appDir:!0,nonce:a},children:(0,_jsxruntime.jsx)(s,{children:(0,_jsxruntime.jsx)(n,{children:(0,_jsxruntime.jsx)(_approuter.default,{actionQueue:c,globalErrorComponentAndStyles:o.G,assetPrefix:o.p})})})})}function AppWithoutContext({reactServerStream:e,preinitScripts:r,clientReferenceManifest:t,nonce:a}){r();const n=_react.default.use((0,_useflightresponse.useFlightStream)(e,t,a)),s=(0,_createinitialrouterstate.createInitialRouterState)({initialFlightData:n.f,initialCanonicalUrlParts:n.c,initialParallelRoutes:new Map,location:null,couldBeIntercepted:n.i,postponed:n.s,prerendered:n.S}),o=(0,_actionqueue.createMutableActionQueue)(s);return(0,_jsxruntime.jsx)(_approuter.default,{actionQueue:o,globalErrorComponentAndStyles:n.G,assetPrefix:n.p})}async function renderToHTMLOrFlightImpl(e,r,t,a,n,s,o,i,c,d,l,u,p){const g="/404"===a;g&&(r.statusCode=404);const m=Date.now(),{serverActionsManifest:_,ComponentMod:S,nextFontManifest:h,serverActions:v,assetPrefix:y="",enableTainting:E}=s;if(S.__next_app__){const e=(0,_clientcomponentrendererlogger.wrapClientComponentLoader)(S);globalThis.__next_require__=e.require,globalThis.__next_chunk_load__=(...r)=>{const t=e.loadChunk(...r);return trackChunkLoading(t),t}}if("development"===process.env.NODE_ENV){const{pathname:r}=new URL(e.url||"/","http://n");null==s.setIsrStatus||s.setIsrStatus.call(s,r,null)}"edge"!==process.env.NEXT_RUNTIME&&(0,_helpers.isNodeNextRequest)(e)&&e.originalRequest.on("end",(()=>{if(c.ended=!0,"performance"in globalThis){const e=(0,_clientcomponentrendererlogger.getClientComponentLoaderMetrics)({reset:!0});e&&(0,_tracer.getTracer)().startSpan(_constants.NextNodeServerSpan.clientComponentLoading,{startTime:e.clientComponentLoadStart,attributes:{"next.clientComponentLoadCount":e.clientComponentLoadCount,"next.span_type":_constants.NextNodeServerSpan.clientComponentLoading}}).end(e.clientComponentLoadStart+e.clientComponentLoadTimes)}}));const f={},R=!!(null==h?void 0:h.appUsingSizeAdjust),w=s.clientReferenceManifest,I=(0,_actionutils.createServerModuleMap)({serverActionsManifest:_});(0,_encryptionutils.setReferenceManifestsSingleton)({page:o.page,clientReferenceManifest:w,serverActionsManifest:_,serverModuleMap:I}),S.patchFetch();const{tree:T,taintObjectReference:b}=S;E&&b("Do not pass process.env to client components since it will leak sensitive data",process.env),o.fetchMetrics=[],f.fetchMetrics=o.fetchMetrics,n={...n},(0,_internalutils.stripInternalQueries)(n);const{flightRouterState:C,isPrefetchRequest:x,isRSCRequest:M,isDevWarmupRequest:P,isHmrRefresh:D,nonce:A}=i;let k;k="edge"===process.env.NEXT_RUNTIME?crypto.randomUUID():require("next/dist/compiled/nanoid").nanoid();const N=s.params??{},{isStaticGeneration:F,fallbackRouteParams:q}=o,H=makeGetDynamicParamFromSegment(N,a,q),j=(0,_serveractionrequestmeta.getServerActionRequestMetadata)(e).isServerAction,L={componentMod:S,url:t,renderOpts:s,workStore:o,parsedRequestHeaders:i,getDynamicParamFromSegment:H,query:n,isPrefetch:x,isAction:j,requestTimestamp:m,appUsingSizeAdjustment:R,flightRouterState:C,requestId:k,pagePath:a,clientReferenceManifest:w,assetPrefix:y,isNotFoundPath:g,nonce:A,res:r,sharedContext:p};if((0,_tracer.getTracer)().setRootSpanAttribute("next.route",a),F){const n=(0,_tracer.getTracer)().wrap(_constants.AppRenderSpan.getBodyResult,{spanName:`prerender route (app) ${a}`,attributes:{"next.route":a}},prerenderToStream),i=await n(e,r,L,f,o,T,l);if(i.dynamicAccess&&(0,_dynamicrendering.accessedDynamicData)(i.dynamicAccess)&&s.isDebugDynamicAccesses){(0,_log.warn)("The following dynamic usage was detected:");for(const e of(0,_dynamicrendering.formatDynamicAPIAccesses)(i.dynamicAccess))(0,_log.warn)(e)}if(i.digestErrorsMap.size){const e=i.digestErrorsMap.values().next().value;if(e)throw e}if(i.ssrErrors.length){const e=i.ssrErrors.find((e=>(0,_createerrorhandler.isUserLandError)(e)));if(e)throw e}const c={metadata:f};if(o.pendingRevalidates||o.pendingRevalidateWrites||o.revalidatedTags){var O;const e=Promise.all([null==(O=o.incrementalCache)?void 0:O.revalidateTag(o.revalidatedTags||[]),...Object.values(o.pendingRevalidates||{}),...o.pendingRevalidateWrites||[]]).finally((()=>{process.env.NEXT_PRIVATE_DEBUG_CACHE&&console.log("pending revalidates promise finished for:",t)}));s.waitUntil?s.waitUntil(e):c.waitUntil=e}i.collectedTags&&(f.fetchTags=i.collectedTags.join(","));const d=String(i.collectedStale);return r.setHeader(_approuterheaders.NEXT_ROUTER_STALE_TIME_HEADER,d),f.headers??={},f.headers[_approuterheaders.NEXT_ROUTER_STALE_TIME_HEADER]=d,!1===o.forceStatic||0===i.collectedRevalidate?f.revalidate=0:f.revalidate=!(i.collectedRevalidate>=_constants1.INFINITE_CACHE)&&i.collectedRevalidate,0===f.revalidate&&(f.staticBailoutInfo={description:o.dynamicUsageDescription,stack:o.dynamicUsageStack}),new _renderresult.default(await(0,_nodewebstreamshelper.streamToString)(i.stream),c)}{const n=s.devRenderResumeDataCache??(null==d?void 0:d.renderResumeDataCache),i=(0,_createcomponenttree.getRootParams)(T,L.getDynamicParamFromSegment),c=(0,_requeststore.createRequestStoreForRender)(e,r,t,i,l,s.onUpdateCookies,s.previewProps,D,u,n);if("development"===process.env.NODE_ENV&&s.setIsrStatus&&"edge"!==process.env.NEXT_RUNTIME&&(0,_helpers.isNodeNextRequest)(e)&&!P){const r=s.setIsrStatus;e.originalRequest.on("end",(()=>{if(!c.usedDynamic&&!o.forceDynamic){const{pathname:t}=new URL(e.url||"/","http://n");r(t,!0)}}))}if(P)return warmupDevRender(e,L);if(M)return generateDynamicFlightRenderResult(e,L,c);const p=(0,_tracer.getTracer)().wrap(_constants.AppRenderSpan.getBodyResult,{spanName:`render route (app) ${a}`,attributes:{"next.route":a}},renderToStream);let g=null;if(j){const t=await(0,_actionhandler.handleAction)({req:e,res:r,ComponentMod:S,serverModuleMap:I,generateFlight:generateDynamicFlightRenderResult,workStore:o,requestStore:c,serverActions:v,ctx:L});if(t){if("not-found"===t.type){const t=createNotFoundLoaderTree(T);r.statusCode=404;const a=await p(c,e,r,L,o,t,g,d);return new _renderresult.default(a,{metadata:f})}if("done"===t.type){if(t.result)return t.result.assignMetadata(f),t.result;t.formState&&(g=t.formState)}}}const m={metadata:f},_=await p(c,e,r,L,o,T,g,d);if(o.pendingRevalidates||o.pendingRevalidateWrites||o.revalidatedTags){var U;const e=Promise.all([null==(U=o.incrementalCache)?void 0:U.revalidateTag(o.revalidatedTags||[]),...Object.values(o.pendingRevalidates||{}),...o.pendingRevalidateWrites||[]]).finally((()=>{process.env.NEXT_PRIVATE_DEBUG_CACHE&&console.log("pending revalidates promise finished for:",t)}));s.waitUntil?s.waitUntil(e):m.waitUntil=e}return new _renderresult.default(_,m)}}const renderToHTMLOrFlight=(e,r,t,a,n,s,o,i,c)=>{if(!e.url)throw Object.defineProperty(new Error("Invalid URL"),"__NEXT_ERROR_CODE",{value:"E182",enumerable:!1,configurable:!0});const d=(0,_parserelativeurl.parseRelativeUrl)(e.url,void 0,!1),l=parseRequestHeaders(e.headers,{isDevWarmup:i,isRoutePPREnabled:!0===s.experimental.isRoutePPREnabled}),{isPrefetchRequest:u}=l,p={ended:!1};let g=null;if("string"==typeof s.postponed){if(n)throw Object.defineProperty(new _invarianterror.InvariantError("postponed state should not be provided when fallback params are provided"),"__NEXT_ERROR_CODE",{value:"E592",enumerable:!1,configurable:!0});g=(0,_postponedstate.parsePostponedState)(s.postponed,s.params)}if((null==g?void 0:g.renderResumeDataCache)&&s.devRenderResumeDataCache)throw Object.defineProperty(new _invarianterror.InvariantError("postponed state and dev warmup immutable resume data cache should not be provided together"),"__NEXT_ERROR_CODE",{value:"E589",enumerable:!1,configurable:!0});const m=(0,_implicittags.getImplicitTags)(s.routeModule.definition.page,d,n),_=(0,_workstore.createWorkStore)({page:s.routeModule.definition.page,fallbackRouteParams:n,renderOpts:s,requestEndedState:p,isPrefetchRequest:u,buildId:c.buildId});return _workasyncstorageexternal.workAsyncStorage.run(_,renderToHTMLOrFlightImpl,e,r,d,t,a,s,_,l,p,g,m,o,c)};async function renderToStream(e,r,t,a,n,s,o,i){const c=a.renderOpts,d=c.ComponentMod,l=c.clientReferenceManifest,{ServerInsertedHTMLProvider:u,renderServerInsertedHTML:p}=(0,_serverinsertedhtml.createServerInsertedHTML)(),{ServerInsertedMetadataProvider:g,getServerInsertedMetadata:m}=(0,_createserverinsertedmetadata.createServerInsertedMetadata)(),_=(0,_utils1.getTracedMetadata)((0,_tracer.getTracer)().getTracePropagationData(),c.experimental.clientTraceMetadata),S=c.buildManifest.polyfillFiles.filter((e=>e.endsWith(".js")&&!e.endsWith(".module.js"))).map((e=>{var r;return{src:`${a.assetPrefix}/_next/${e}${(0,_getassetquerystring.getAssetQueryString)(a,!1)}`,integrity:null==(r=c.subresourceIntegrityManifest)?void 0:r[e],crossOrigin:c.crossOrigin,noModule:!0,nonce:a.nonce}})),[h,v]=(0,_requiredscripts.getRequiredScripts)(c.buildManifest,a.assetPrefix,c.crossOrigin,c.subresourceIntegrityManifest,(0,_getassetquerystring.getAssetQueryString)(a,!0),a.nonce,c.page),y=new Map,E=!1;function f(e){return null==c.onInstrumentationRequestError?void 0:c.onInstrumentationRequestError.call(c,e,r,createErrorContext(a,"react-server-components"))}const R=(0,_createerrorhandler.createHTMLReactServerErrorHandler)(!!c.dev,!!c.nextExport,y,E,f);function w(e){return null==c.onInstrumentationRequestError?void 0:c.onInstrumentationRequestError.call(c,e,r,createErrorContext(a,"server-rendering"))}const I=[],T=(0,_createerrorhandler.createHTMLErrorHandler)(!!c.dev,!!c.nextExport,y,I,E,w);let b=null;const C=t.setHeader.bind(t),x=t.appendHeader.bind(t);try{if(c.dev&&"development"===process.env.NODE_ENV&&"edge"!==process.env.NEXT_RUNTIME&&c.experimental.dynamicIO){const r=await _workunitasyncstorageexternal.workUnitAsyncStorage.run(e,getRSCPayload,s,a,404===t.statusCode),[o,i]=createValidationOutlet();r._validation=i;const c=await _workunitasyncstorageexternal.workUnitAsyncStorage.run(e,_apprenderrenderutils.scheduleInSequentialTasks,(()=>(e.prerenderPhase=!0,d.renderToReadableStream(r,l.clientModules,{onError:R,environmentName:()=>!0===e.prerenderPhase?"Prerender":"Server",filterStackFrame:(e,r)=>!e.startsWith("node:")&&!e.includes("node_modules")}))),(()=>{e.prerenderPhase=!1}));spawnDynamicValidationInDev(o,s,a,404===t.statusCode,l,n.route,e),b=new _apprenderprerenderutils.ReactServerResult(c)}else{const r=await _workunitasyncstorageexternal.workUnitAsyncStorage.run(e,getRSCPayload,s,a,404===t.statusCode);b=new _apprenderprerenderutils.ReactServerResult(_workunitasyncstorageexternal.workUnitAsyncStorage.run(e,d.renderToReadableStream,r,l.clientModules,{onError:R}))}if(await(0,_scheduler.waitAtLeastOneReactRenderTask)(),"string"==typeof c.postponed){if((null==i?void 0:i.type)===_postponedstate.DynamicState.DATA){const e=(0,_useflightresponse.createInlinedDataReadableStream)(b.tee(),a.nonce,o);return(0,_nodewebstreamshelper.chainStreams)(e,(0,_nodewebstreamshelper.createDocumentClosingStream)())}if(i){const r=(0,_postponedstate.getPostponedFromState)(i),t=require("react-dom/server.edge").resume,n=await _workunitasyncstorageexternal.workUnitAsyncStorage.run(e,t,(0,_jsxruntime.jsx)(App,{reactServerStream:b.tee(),preinitScripts:h,clientReferenceManifest:l,ServerInsertedHTMLProvider:u,ServerInsertedMetadataProvider:g,nonce:a.nonce}),r,{onError:T,nonce:a.nonce}),s=(0,_makegetserverinsertedhtml.makeGetServerInsertedHTML)({polyfills:S,renderServerInsertedHTML:p,serverCapturedErrors:I,basePath:c.basePath,tracingMetadata:_});return await(0,_nodewebstreamshelper.continueDynamicHTMLResume)(n,{inlinedDataStream:(0,_useflightresponse.createInlinedDataReadableStream)(b.consume(),a.nonce,o),getServerInsertedHTML:s,getServerInsertedMetadata:m})}}const r=require("react-dom/server.edge").renderToReadableStream,y=await _workunitasyncstorageexternal.workUnitAsyncStorage.run(e,r,(0,_jsxruntime.jsx)(App,{reactServerStream:b.tee(),preinitScripts:h,clientReferenceManifest:l,ServerInsertedHTMLProvider:u,ServerInsertedMetadataProvider:g,nonce:a.nonce}),{onError:T,nonce:a.nonce,onHeaders:e=>{e.forEach(((e,r)=>{x(r,e)}))},maxHeadersLength:c.reactMaxHeadersLength,bootstrapScripts:[v],formState:o}),E=(0,_makegetserverinsertedhtml.makeGetServerInsertedHTML)({polyfills:S,renderServerInsertedHTML:p,serverCapturedErrors:I,basePath:c.basePath,tracingMetadata:_}),f=!0!==c.supportsDynamicResponse||!!c.shouldWaitOnAllReady,w=c.dev;return await(0,_nodewebstreamshelper.continueFizzStream)(y,{inlinedDataStream:(0,_useflightresponse.createInlinedDataReadableStream)(b.consume(),a.nonce,o),isStaticGeneration:f,getServerInsertedHTML:E,getServerInsertedMetadata:m,validateRootLayout:w})}catch(r){if((0,_staticgenerationbailout.isStaticGenBailoutError)(r)||"object"==typeof r&&null!==r&&"message"in r&&"string"==typeof r.message&&r.message.includes("https://nextjs.org/docs/advanced-features/static-html-export"))throw r;const n=(0,_bailouttocsr.isBailoutToCSRError)(r);if(n){const e=(0,_formatservererror.getStackWithoutErrorMessage)(r);throw(0,_log.error)(`${r.reason} should be wrapped in a suspense boundary at page "${a.pagePath}". Read more: https://nextjs.org/docs/messages/missing-suspense-with-csr-bailout\n${e}`),r}let i;if((0,_httpaccessfallback.isHTTPAccessFallbackError)(r))t.statusCode=(0,_httpaccessfallback.getAccessFallbackHTTPStatus)(r),i=(0,_httpaccessfallback.getAccessFallbackErrorTypeByStatus)(t.statusCode);else if((0,_redirecterror.isRedirectError)(r)){i="redirect",t.statusCode=(0,_redirect.getRedirectStatusCodeFromError)(r);const a=(0,_addpathprefix.addPathPrefix)((0,_redirect.getURLFromRedirectError)(r),c.basePath),n=new Headers;(0,_requestcookies.appendMutableCookies)(n,e.mutableCookies)&&C("set-cookie",Array.from(n.values())),C("location",a)}else n||(t.statusCode=500);const[u,g]=(0,_requiredscripts.getRequiredScripts)(c.buildManifest,a.assetPrefix,c.crossOrigin,c.subresourceIntegrityManifest,(0,_getassetquerystring.getAssetQueryString)(a,!1),a.nonce,"/_not-found/page"),h=await _workunitasyncstorageexternal.workUnitAsyncStorage.run(e,getErrorRSCPayload,s,a,y.has(r.digest)?null:r,i),v=_workunitasyncstorageexternal.workUnitAsyncStorage.run(e,d.renderToReadableStream,h,l.clientModules,{onError:R});if(null===b)throw r;try{const r=await _workunitasyncstorageexternal.workUnitAsyncStorage.run(e,_nodewebstreamshelper.renderToInitialFizzStream,{ReactDOMServer:require("react-dom/server.edge"),element:(0,_jsxruntime.jsx)(AppWithoutContext,{reactServerStream:v,preinitScripts:u,clientReferenceManifest:l,nonce:a.nonce}),streamOptions:{nonce:a.nonce,bootstrapScripts:[g],formState:o}}),t=!0!==c.supportsDynamicResponse||!!c.shouldWaitOnAllReady,n=c.dev;return await(0,_nodewebstreamshelper.continueFizzStream)(r,{inlinedDataStream:(0,_useflightresponse.createInlinedDataReadableStream)(b.consume(),a.nonce,o),isStaticGeneration:t,getServerInsertedHTML:(0,_makegetserverinsertedhtml.makeGetServerInsertedHTML)({polyfills:S,renderServerInsertedHTML:p,serverCapturedErrors:[],basePath:c.basePath,tracingMetadata:_}),getServerInsertedMetadata:m,validateRootLayout:n})}catch(e){if("development"===process.env.NODE_ENV&&(0,_httpaccessfallback.isHTTPAccessFallbackError)(e)){const{bailOnRootNotFound:e}=require("../../client/components/dev-root-http-access-fallback-boundary");e()}throw e}}}function createValidationOutlet(){let e,r=new Promise((r=>{e=r}));return[e,r]}async function spawnDynamicValidationInDev(e,r,t,a,n,s,o){const{componentMod:i}=t,c=(0,_createcomponenttree.getRootParams)(i.tree,t.getDynamicParamFromSegment),d=new AbortController,l=new AbortController,u=new _cachesignal.CacheSignal,p=(0,_resumedatacache.createPrerenderResumeDataCache)(),g={type:"prerender",phase:"render",rootParams:c,implicitTags:[],renderSignal:l.signal,controller:d,cacheSignal:u,dynamicTracking:null,revalidate:_constants1.INFINITE_CACHE,expire:_constants1.INFINITE_CACHE,stale:_constants1.INFINITE_CACHE,tags:[],prerenderResumeDataCache:p},m=new AbortController,_={type:"prerender",phase:"render",rootParams:c,implicitTags:[],renderSignal:m.signal,controller:m,cacheSignal:u,dynamicTracking:null,revalidate:_constants1.INFINITE_CACHE,expire:_constants1.INFINITE_CACHE,stale:_constants1.INFINITE_CACHE,tags:[],prerenderResumeDataCache:p},S=await _workunitasyncstorageexternal.workUnitAsyncStorage.run(g,getRSCPayload,r,t,a);let h;try{h=_workunitasyncstorageexternal.workUnitAsyncStorage.run(g,i.renderToReadableStream,S,n.clientModules,{onError:e=>{const r=(0,_createerrorhandler.getDigestForWellKnownError)(e);if(r)return r;d.signal.aborted||l.signal.aborted||(process.env.NEXT_DEBUG_BUILD||process.env.__NEXT_VERBOSE_LOGGING)&&(0,_prospectiverenderutils.printDebugThrownValueForProspectiveRender)(e,s)},signal:l.signal})}catch(e){d.signal.aborted||l.signal.aborted||(process.env.NEXT_DEBUG_BUILD||process.env.__NEXT_VERBOSE_LOGGING)&&(0,_prospectiverenderutils.printDebugThrownValueForProspectiveRender)(e,s)}const{ServerInsertedHTMLProvider:v}=(0,_serverinsertedhtml.createServerInsertedHTML)(),{ServerInsertedMetadataProvider:y}=(0,_createserverinsertedmetadata.createServerInsertedMetadata)(),E="1";if(h){const[e,r]=h.tee();h=null,await warmFlightResponse(e,n);const t=require("react-dom/static.edge").prerender;_workunitasyncstorageexternal.workUnitAsyncStorage.run(_,t,(0,_jsxruntime.jsx)(App,{reactServerStream:r,preinitScripts:()=>{},clientReferenceManifest:n,ServerInsertedHTMLProvider:v,ServerInsertedMetadataProvider:y,nonce:E}),{signal:m.signal,onError:e=>{const r=(0,_createerrorhandler.getDigestForWellKnownError)(e);if(r)return r;m.signal.aborted||(process.env.NEXT_DEBUG_BUILD||process.env.__NEXT_VERBOSE_LOGGING)&&(0,_prospectiverenderutils.printDebugThrownValueForProspectiveRender)(e,s)}}).catch((e=>{m.signal.aborted||process.env.__NEXT_VERBOSE_LOGGING&&(0,_prospectiverenderutils.printDebugThrownValueForProspectiveRender)(e,s)}))}await u.cacheReady(),m.abort(),l.abort(),d.abort();const f=new AbortController,R=(0,_dynamicrendering.createDynamicTrackingState)(!1),w={type:"prerender",phase:"render",rootParams:c,implicitTags:[],renderSignal:f.signal,controller:f,cacheSignal:null,dynamicTracking:R,revalidate:_constants1.INFINITE_CACHE,expire:_constants1.INFINITE_CACHE,stale:_constants1.INFINITE_CACHE,tags:[],prerenderResumeDataCache:p},I=new AbortController,T=(0,_dynamicrendering.createDynamicTrackingState)(!1),b=(0,_dynamicrendering.createDynamicValidationState)(),C={type:"prerender",phase:"render",rootParams:c,implicitTags:[],renderSignal:I.signal,controller:I,cacheSignal:null,dynamicTracking:T,revalidate:_constants1.INFINITE_CACHE,expire:_constants1.INFINITE_CACHE,stale:_constants1.INFINITE_CACHE,tags:[],prerenderResumeDataCache:p},x=await _workunitasyncstorageexternal.workUnitAsyncStorage.run(w,getRSCPayload,r,t,a),M=(await(0,_apprenderprerenderutils.prerenderServerWithPhases)(f.signal,(()=>_workunitasyncstorageexternal.workUnitAsyncStorage.run(w,i.renderToReadableStream,x,n.clientModules,{onError:e=>(0,_usecacheerrors.isUseCacheTimeoutError)(e)||f.signal.aborted&&(0,_dynamicrendering.isPrerenderInterruptedError)(e)?e.digest:(0,_createerrorhandler.getDigestForWellKnownError)(e),signal:f.signal})),(()=>{f.abort()}))).asPhasedStream();try{const e=require("react-dom/static.edge").prerender;await(0,_apprenderprerenderutils.prerenderClientWithPhases)((()=>_workunitasyncstorageexternal.workUnitAsyncStorage.run(C,e,(0,_jsxruntime.jsx)(App,{reactServerStream:M,preinitScripts:()=>{},clientReferenceManifest:n,ServerInsertedHTMLProvider:v,ServerInsertedMetadataProvider:y,nonce:t.nonce}),{signal:I.signal,onError:(e,r)=>{if((0,_usecacheerrors.isUseCacheTimeoutError)(e))b.dynamicErrors.push(e);else{if(!(0,_dynamicrendering.isPrerenderInterruptedError)(e)&&!I.signal.aborted)return(0,_createerrorhandler.getDigestForWellKnownError)(e);{o.usedDynamic=!0;const e=r.componentStack;"string"==typeof e&&(0,_dynamicrendering.trackAllowedDynamicAccess)(s,e,b,R,T)}}}})),(()=>{I.abort(),M.assertExhausted()}))}catch(e){(0,_dynamicrendering.isPrerenderInterruptedError)(e)||I.signal.aborted}function P(){try{(0,_dynamicrendering.throwIfDisallowedDynamic)(s,b,R,T)}catch{}return null}e((0,_jsxruntime.jsx)(P,{}))}function shouldGenerateStaticFlightData(e){const{isStaticGeneration:r}=e;return!!r}async function prerenderToStream(e,r,t,a,n,s,o){const i=null,c=(0,_createcomponenttree.getRootParams)(s,t.getDynamicParamFromSegment),d=t.renderOpts,l=d.ComponentMod,u=d.clientReferenceManifest,p=n.fallbackRouteParams,{ServerInsertedHTMLProvider:g,renderServerInsertedHTML:m}=(0,_serverinsertedhtml.createServerInsertedHTML)(),{ServerInsertedMetadataProvider:_,getServerInsertedMetadata:S}=(0,_createserverinsertedmetadata.createServerInsertedMetadata)(),h=(0,_utils1.getTracedMetadata)((0,_tracer.getTracer)().getTracePropagationData(),d.experimental.clientTraceMetadata),v=d.buildManifest.polyfillFiles.filter((e=>e.endsWith(".js")&&!e.endsWith(".module.js"))).map((e=>{var r;return{src:`${t.assetPrefix}/_next/${e}${(0,_getassetquerystring.getAssetQueryString)(t,!1)}`,integrity:null==(r=d.subresourceIntegrityManifest)?void 0:r[e],crossOrigin:d.crossOrigin,noModule:!0,nonce:t.nonce}})),[y,E]=(0,_requiredscripts.getRequiredScripts)(d.buildManifest,t.assetPrefix,d.crossOrigin,d.subresourceIntegrityManifest,(0,_getassetquerystring.getAssetQueryString)(t,!0),t.nonce,d.page),f=new Map,R=!!d.experimental.isRoutePPREnabled;function w(r){return null==d.onInstrumentationRequestError?void 0:d.onInstrumentationRequestError.call(d,r,e,createErrorContext(t,"react-server-components"))}const I=(0,_createerrorhandler.createHTMLReactServerErrorHandler)(!!d.dev,!!d.nextExport,f,R,w);function T(r){return null==d.onInstrumentationRequestError?void 0:d.onInstrumentationRequestError.call(d,r,e,createErrorContext(t,"server-rendering"))}const b=[],C=(0,_createerrorhandler.createHTMLErrorHandler)(!!d.dev,!!d.nextExport,f,b,R,T);let x=null;const M=e=>{a.headers??={},a.headers[e]=r.getHeader(e)},P=(e,t)=>(r.setHeader(e,t),M(e),r),D=(e,t)=>{Array.isArray(t)?t.forEach((t=>{r.appendHeader(e,t)})):r.appendHeader(e,t),M(e)};let A=null;try{if(d.experimental.dynamicIO){if(d.experimental.isRoutePPREnabled){const e=new AbortController,R=new AbortController,w=new _cachesignal.CacheSignal,T=(0,_resumedatacache.createPrerenderResumeDataCache)(),M=A={type:"prerender",phase:"render",rootParams:c,implicitTags:o,renderSignal:R.signal,controller:e,cacheSignal:w,dynamicTracking:null,revalidate:_constants1.INFINITE_CACHE,expire:_constants1.INFINITE_CACHE,stale:_constants1.INFINITE_CACHE,tags:[...o],prerenderResumeDataCache:T},P=await _workunitasyncstorageexternal.workUnitAsyncStorage.run(M,getRSCPayload,s,t,404===r.statusCode),k=_workunitasyncstorageexternal.workUnitAsyncStorage.run(M,l.prerender,P,u.clientModules,{onError:r=>{const t=(0,_createerrorhandler.getDigestForWellKnownError)(r);if(t)return t;e.signal.aborted||(process.env.NEXT_DEBUG_BUILD||process.env.__NEXT_VERBOSE_LOGGING)&&(0,_prospectiverenderutils.printDebugThrownValueForProspectiveRender)(r,n.route)},onPostpone:void 0,signal:R.signal});let N;await w.cacheReady(),R.abort(),e.abort();try{N=await(0,_apprenderprerenderutils.createReactServerPrerenderResult)(k)}catch(r){R.signal.aborted||e.signal.aborted||(process.env.NEXT_DEBUG_BUILD||process.env.__NEXT_VERBOSE_LOGGING)&&(0,_prospectiverenderutils.printDebugThrownValueForProspectiveRender)(r,n.route)}if(N){await warmFlightResponse(N.asStream(),u);const e=new AbortController,r={type:"prerender",phase:"render",rootParams:c,implicitTags:o,renderSignal:e.signal,controller:e,cacheSignal:null,dynamicTracking:null,revalidate:_constants1.INFINITE_CACHE,expire:_constants1.INFINITE_CACHE,stale:_constants1.INFINITE_CACHE,tags:[...o],prerenderResumeDataCache:T},a=require("react-dom/static.edge").prerender;await(0,_apprenderprerenderutils.prerenderAndAbortInSequentialTasks)((()=>_workunitasyncstorageexternal.workUnitAsyncStorage.run(r,a,(0,_jsxruntime.jsx)(App,{reactServerStream:N.asUnclosingStream(),preinitScripts:y,clientReferenceManifest:u,ServerInsertedHTMLProvider:g,ServerInsertedMetadataProvider:_,nonce:t.nonce}),{signal:e.signal,onError:r=>{const t=(0,_createerrorhandler.getDigestForWellKnownError)(r);if(t)return t;e.signal.aborted||(process.env.NEXT_DEBUG_BUILD||process.env.__NEXT_VERBOSE_LOGGING)&&(0,_prospectiverenderutils.printDebugThrownValueForProspectiveRender)(r,n.route)},bootstrapScripts:[E]})),(()=>{e.abort()})).catch((e=>{R.signal.aborted||(0,_dynamicrendering.isPrerenderInterruptedError)(e)||(process.env.NEXT_DEBUG_BUILD||process.env.__NEXT_VERBOSE_LOGGING)&&(0,_prospectiverenderutils.printDebugThrownValueForProspectiveRender)(e,n.route)}))}let F=!1;const q=new AbortController,H=(0,_dynamicrendering.createDynamicTrackingState)(d.isDebugDynamicAccesses),j=A={type:"prerender",phase:"render",rootParams:c,implicitTags:o,renderSignal:q.signal,controller:q,cacheSignal:null,dynamicTracking:H,revalidate:_constants1.INFINITE_CACHE,expire:_constants1.INFINITE_CACHE,stale:_constants1.INFINITE_CACHE,tags:[...o],prerenderResumeDataCache:T},L=await _workunitasyncstorageexternal.workUnitAsyncStorage.run(j,getRSCPayload,s,t,404===r.statusCode);let O=!0;const U=x=await(0,_apprenderprerenderutils.createReactServerPrerenderResult)((0,_apprenderprerenderutils.prerenderAndAbortInSequentialTasks)((async()=>{const e=await _workunitasyncstorageexternal.workUnitAsyncStorage.run(j,l.prerender,L,u.clientModules,{onError:e=>I(e),signal:q.signal});return O=!1,e}),(()=>{q.signal.aborted?F=!0:(O&&(F=!0),q.abort())}))),G=(0,_dynamicrendering.createDynamicTrackingState)(d.isDebugDynamicAccesses),B=new AbortController,V={type:"prerender",phase:"render",rootParams:c,implicitTags:o,renderSignal:B.signal,controller:B,cacheSignal:null,dynamicTracking:G,revalidate:_constants1.INFINITE_CACHE,expire:_constants1.INFINITE_CACHE,stale:_constants1.INFINITE_CACHE,tags:[...o],prerenderResumeDataCache:T};let X=!1,W=(0,_dynamicrendering.createDynamicValidationState)();const z=require("react-dom/static.edge").prerender;let{prelude:K,postponed:$}=await(0,_apprenderprerenderutils.prerenderAndAbortInSequentialTasks)((()=>_workunitasyncstorageexternal.workUnitAsyncStorage.run(V,z,(0,_jsxruntime.jsx)(App,{reactServerStream:U.asUnclosingStream(),preinitScripts:y,clientReferenceManifest:u,ServerInsertedHTMLProvider:g,ServerInsertedMetadataProvider:_,nonce:t.nonce}),{signal:B.signal,onError:(e,r)=>{if(!(0,_dynamicrendering.isPrerenderInterruptedError)(e)&&!B.signal.aborted)return C(e,r);{X=!0;const e=r.componentStack;"string"==typeof e&&(0,_dynamicrendering.trackAllowedDynamicAccess)(n.route,e,W,H,G)}},onHeaders:e=>{e.forEach(((e,r)=>{D(r,e)}))},maxHeadersLength:d.reactMaxHeadersLength,bootstrapScripts:[E]})),(()=>{B.abort()}));(0,_dynamicrendering.throwIfDisallowedDynamic)(n.route,W,H,G);const Q=(0,_makegetserverinsertedhtml.makeGetServerInsertedHTML)({polyfills:v,renderServerInsertedHTML:m,serverCapturedErrors:b,basePath:d.basePath,tracingMetadata:h}),J=await(0,_nodewebstreamshelper.streamToBuffer)(U.asStream());if(a.flightData=J,a.segmentData=await collectSegmentData(J,j,l,d,p),F||X)return a.postponed=null!=$?await(0,_postponedstate.getDynamicHTMLPostponedState)($,p,T):await(0,_postponedstate.getDynamicDataPostponedState)(T),U.consume(),{digestErrorsMap:f,ssrErrors:b,stream:await(0,_nodewebstreamshelper.continueDynamicPrerender)(K,{getServerInsertedHTML:Q,getServerInsertedMetadata:S}),dynamicAccess:(0,_dynamicrendering.consumeDynamicAccess)(H,G),collectedRevalidate:j.revalidate,collectedExpire:j.expire,collectedStale:j.stale,collectedTags:j.tags};{if(n.forceDynamic)throw Object.defineProperty(new _staticgenerationbailout.StaticGenBailoutError('Invariant: a Page with `dynamic = "force-dynamic"` did not trigger the dynamic pathway. This is a bug in Next.js'),"__NEXT_ERROR_CODE",{value:"E598",enumerable:!1,configurable:!0});let e=K;if(null!=$){const r=require("react-dom/server.edge").resume,a=new ReadableStream,n=await r((0,_jsxruntime.jsx)(App,{reactServerStream:a,preinitScripts:()=>{},clientReferenceManifest:u,ServerInsertedHTMLProvider:g,ServerInsertedMetadataProvider:_,nonce:t.nonce}),JSON.parse(JSON.stringify($)),{signal:(0,_dynamicrendering.createPostponedAbortSignal)("static prerender resume"),onError:C,nonce:t.nonce});e=(0,_nodewebstreamshelper.chainStreams)(K,n)}return{digestErrorsMap:f,ssrErrors:b,stream:await(0,_nodewebstreamshelper.continueStaticPrerender)(e,{inlinedDataStream:(0,_useflightresponse.createInlinedDataReadableStream)(U.consumeAsStream(),t.nonce,i),getServerInsertedHTML:Q,getServerInsertedMetadata:S}),dynamicAccess:(0,_dynamicrendering.consumeDynamicAccess)(H,G),collectedRevalidate:j.revalidate,collectedExpire:j.expire,collectedStale:j.stale,collectedTags:j.tags}}}{if(!n.incrementalCache)throw Object.defineProperty(new Error("Expected incremental cache to exist. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E205",enumerable:!1,configurable:!0});const e=new AbortController,R=new AbortController,w=new _cachesignal.CacheSignal,T=(0,_resumedatacache.createPrerenderResumeDataCache)(),M=A={type:"prerender",phase:"render",rootParams:c,implicitTags:o,renderSignal:R.signal,controller:e,cacheSignal:w,dynamicTracking:null,revalidate:_constants1.INFINITE_CACHE,expire:_constants1.INFINITE_CACHE,stale:_constants1.INFINITE_CACHE,tags:[...o],prerenderResumeDataCache:T},P=new AbortController,D=A={type:"prerender",phase:"render",rootParams:c,implicitTags:o,renderSignal:P.signal,controller:P,cacheSignal:w,dynamicTracking:null,revalidate:_constants1.INFINITE_CACHE,expire:_constants1.INFINITE_CACHE,stale:_constants1.INFINITE_CACHE,tags:[...o],prerenderResumeDataCache:T},k=await _workunitasyncstorageexternal.workUnitAsyncStorage.run(M,getRSCPayload,s,t,404===r.statusCode);let N;try{N=_workunitasyncstorageexternal.workUnitAsyncStorage.run(M,l.renderToReadableStream,k,u.clientModules,{onError:r=>{const t=(0,_createerrorhandler.getDigestForWellKnownError)(r);if(t)return t;e.signal.aborted||R.signal.aborted||(process.env.NEXT_DEBUG_BUILD||process.env.__NEXT_VERBOSE_LOGGING)&&(0,_prospectiverenderutils.printDebugThrownValueForProspectiveRender)(r,n.route)},signal:R.signal})}catch(r){e.signal.aborted||R.signal.aborted||(process.env.NEXT_DEBUG_BUILD||process.env.__NEXT_VERBOSE_LOGGING)&&(0,_prospectiverenderutils.printDebugThrownValueForProspectiveRender)(r,n.route)}if(N){const[e,r]=N.tee();N=null,await warmFlightResponse(e,u);const a=require("react-dom/static.edge").prerender;_workunitasyncstorageexternal.workUnitAsyncStorage.run(D,a,(0,_jsxruntime.jsx)(App,{reactServerStream:r,preinitScripts:y,clientReferenceManifest:u,ServerInsertedHTMLProvider:g,ServerInsertedMetadataProvider:_,nonce:t.nonce}),{signal:P.signal,onError:e=>{const r=(0,_createerrorhandler.getDigestForWellKnownError)(e);if(r)return r;P.signal.aborted||(process.env.NEXT_DEBUG_BUILD||process.env.__NEXT_VERBOSE_LOGGING)&&(0,_prospectiverenderutils.printDebugThrownValueForProspectiveRender)(e,n.route)},bootstrapScripts:[E]}).catch((e=>{P.signal.aborted||process.env.__NEXT_VERBOSE_LOGGING&&(0,_prospectiverenderutils.printDebugThrownValueForProspectiveRender)(e,n.route)}))}await w.cacheReady(),P.abort(),R.abort(),e.abort();let F=!1;const q=new AbortController,H=(0,_dynamicrendering.createDynamicTrackingState)(d.isDebugDynamicAccesses),j=A={type:"prerender",phase:"render",rootParams:c,implicitTags:o,renderSignal:q.signal,controller:q,cacheSignal:null,dynamicTracking:H,revalidate:_constants1.INFINITE_CACHE,expire:_constants1.INFINITE_CACHE,stale:_constants1.INFINITE_CACHE,tags:[...o],prerenderResumeDataCache:T};let L=!1;const O=new AbortController,U=(0,_dynamicrendering.createDynamicTrackingState)(d.isDebugDynamicAccesses),G=(0,_dynamicrendering.createDynamicValidationState)(),B=A={type:"prerender",phase:"render",rootParams:c,implicitTags:o,renderSignal:O.signal,controller:O,cacheSignal:null,dynamicTracking:U,revalidate:_constants1.INFINITE_CACHE,expire:_constants1.INFINITE_CACHE,stale:_constants1.INFINITE_CACHE,tags:[...o],prerenderResumeDataCache:T},V=await _workunitasyncstorageexternal.workUnitAsyncStorage.run(j,getRSCPayload,s,t,404===r.statusCode),X=x=await(0,_apprenderprerenderutils.prerenderServerWithPhases)(q.signal,(()=>_workunitasyncstorageexternal.workUnitAsyncStorage.run(j,l.renderToReadableStream,V,u.clientModules,{onError:e=>q.signal.aborted?(F=!0,(0,_dynamicrendering.isPrerenderInterruptedError)(e)?e.digest:(0,_createerrorhandler.getDigestForWellKnownError)(e)):I(e),signal:q.signal})),(()=>{q.abort()}));let W;const z=X.asPhasedStream();try{const e=require("react-dom/static.edge").prerender;W=(await(0,_apprenderprerenderutils.prerenderClientWithPhases)((()=>_workunitasyncstorageexternal.workUnitAsyncStorage.run(B,e,(0,_jsxruntime.jsx)(App,{reactServerStream:z,preinitScripts:y,clientReferenceManifest:u,ServerInsertedHTMLProvider:g,ServerInsertedMetadataProvider:_,nonce:t.nonce}),{signal:O.signal,onError:(e,r)=>{if(!(0,_dynamicrendering.isPrerenderInterruptedError)(e)&&!O.signal.aborted)return C(e,r);{L=!0;const e=r.componentStack;"string"==typeof e&&(0,_dynamicrendering.trackAllowedDynamicAccess)(n.route,e,G,H,U)}},bootstrapScripts:[E]})),(()=>{O.abort(),z.assertExhausted()}))).prelude}catch(e){if(!(0,_dynamicrendering.isPrerenderInterruptedError)(e)&&!O.signal.aborted)throw e}if((0,_dynamicrendering.throwIfDisallowedDynamic)(n.route,G,H,U),F||L){const e=F?(0,_dynamicrendering.getFirstDynamicReason)(H):(0,_dynamicrendering.getFirstDynamicReason)(U);throw e?Object.defineProperty(new _hooksservercontext.DynamicServerError(`Route "${n.route}" couldn't be rendered statically because it used \`${e}\`. See more info here: https://nextjs.org/docs/messages/next-prerender-data`),"__NEXT_ERROR_CODE",{value:"E586",enumerable:!1,configurable:!0}):Object.defineProperty(new _hooksservercontext.DynamicServerError(`Route "${n.route}" couldn't be rendered statically it accessed data without explicitly caching it. See more info here: https://nextjs.org/docs/messages/next-prerender-data`),"__NEXT_ERROR_CODE",{value:"E583",enumerable:!1,configurable:!0})}const K=await(0,_nodewebstreamshelper.streamToBuffer)(X.asStream());a.flightData=K,a.segmentData=await collectSegmentData(K,B,l,d,p);const $=(0,_makegetserverinsertedhtml.makeGetServerInsertedHTML)({polyfills:v,renderServerInsertedHTML:m,serverCapturedErrors:b,basePath:d.basePath,tracingMetadata:h}),Q=d.dev;return{digestErrorsMap:f,ssrErrors:b,stream:await(0,_nodewebstreamshelper.continueFizzStream)(W,{inlinedDataStream:(0,_useflightresponse.createInlinedDataReadableStream)(X.asStream(),t.nonce,i),isStaticGeneration:!0,getServerInsertedHTML:$,getServerInsertedMetadata:S,validateRootLayout:Q}),dynamicAccess:(0,_dynamicrendering.consumeDynamicAccess)(H,U),collectedRevalidate:j.revalidate,collectedExpire:j.expire,collectedStale:j.stale,collectedTags:j.tags}}}if(d.experimental.isRoutePPREnabled){let e=(0,_dynamicrendering.createDynamicTrackingState)(d.isDebugDynamicAccesses);const R=(0,_resumedatacache.createPrerenderResumeDataCache)(),w=A={type:"prerender-ppr",phase:"render",rootParams:c,implicitTags:o,dynamicTracking:e,revalidate:_constants1.INFINITE_CACHE,expire:_constants1.INFINITE_CACHE,stale:_constants1.INFINITE_CACHE,tags:[...o],prerenderResumeDataCache:R},T=await _workunitasyncstorageexternal.workUnitAsyncStorage.run(w,getRSCPayload,s,t,404===r.statusCode),M=x=await(0,_apprenderprerenderutils.createReactServerPrerenderResultFromRender)(_workunitasyncstorageexternal.workUnitAsyncStorage.run(w,l.renderToReadableStream,T,u.clientModules,{onError:I})),P={type:"prerender-ppr",phase:"render",rootParams:c,implicitTags:o,dynamicTracking:e,revalidate:_constants1.INFINITE_CACHE,expire:_constants1.INFINITE_CACHE,stale:_constants1.INFINITE_CACHE,tags:[...o],prerenderResumeDataCache:R},k=require("react-dom/static.edge").prerender,{prelude:N,postponed:F}=await _workunitasyncstorageexternal.workUnitAsyncStorage.run(P,k,(0,_jsxruntime.jsx)(App,{reactServerStream:M.asUnclosingStream(),preinitScripts:y,clientReferenceManifest:u,ServerInsertedHTMLProvider:g,ServerInsertedMetadataProvider:_,nonce:t.nonce}),{onError:C,onHeaders:e=>{e.forEach(((e,r)=>{D(r,e)}))},maxHeadersLength:d.reactMaxHeadersLength,bootstrapScripts:[E]}),q=(0,_makegetserverinsertedhtml.makeGetServerInsertedHTML)({polyfills:v,renderServerInsertedHTML:m,serverCapturedErrors:b,basePath:d.basePath,tracingMetadata:h}),H=await(0,_nodewebstreamshelper.streamToBuffer)(M.asStream());if(shouldGenerateStaticFlightData(n)&&(a.flightData=H,a.segmentData=await collectSegmentData(H,P,l,d,p)),(0,_dynamicrendering.accessedDynamicData)(e.dynamicAccesses))return a.postponed=null!=F?await(0,_postponedstate.getDynamicHTMLPostponedState)(F,p,R):await(0,_postponedstate.getDynamicDataPostponedState)(R),M.consume(),{digestErrorsMap:f,ssrErrors:b,stream:await(0,_nodewebstreamshelper.continueDynamicPrerender)(N,{getServerInsertedHTML:q,getServerInsertedMetadata:S}),dynamicAccess:e.dynamicAccesses,collectedRevalidate:w.revalidate,collectedExpire:w.expire,collectedStale:w.stale,collectedTags:w.tags};if(p&&p.size>0)return a.postponed=await(0,_postponedstate.getDynamicDataPostponedState)(R),{digestErrorsMap:f,ssrErrors:b,stream:await(0,_nodewebstreamshelper.continueDynamicPrerender)(N,{getServerInsertedHTML:q,getServerInsertedMetadata:S}),dynamicAccess:e.dynamicAccesses,collectedRevalidate:w.revalidate,collectedExpire:w.expire,collectedStale:w.stale,collectedTags:w.tags};{if(n.forceDynamic)throw Object.defineProperty(new _staticgenerationbailout.StaticGenBailoutError('Invariant: a Page with `dynamic = "force-dynamic"` did not trigger the dynamic pathway. This is a bug in Next.js'),"__NEXT_ERROR_CODE",{value:"E598",enumerable:!1,configurable:!0});let r=N;if(null!=F){const e=require("react-dom/server.edge").resume,a=new ReadableStream,n=await e((0,_jsxruntime.jsx)(App,{reactServerStream:a,preinitScripts:()=>{},clientReferenceManifest:u,ServerInsertedHTMLProvider:g,ServerInsertedMetadataProvider:_,nonce:t.nonce}),JSON.parse(JSON.stringify(F)),{signal:(0,_dynamicrendering.createPostponedAbortSignal)("static prerender resume"),onError:C,nonce:t.nonce});r=(0,_nodewebstreamshelper.chainStreams)(N,n)}return{digestErrorsMap:f,ssrErrors:b,stream:await(0,_nodewebstreamshelper.continueStaticPrerender)(r,{inlinedDataStream:(0,_useflightresponse.createInlinedDataReadableStream)(M.consumeAsStream(),t.nonce,i),getServerInsertedHTML:q,getServerInsertedMetadata:S}),dynamicAccess:e.dynamicAccesses,collectedRevalidate:w.revalidate,collectedExpire:w.expire,collectedStale:w.stale,collectedTags:w.tags}}}{const e=A={type:"prerender-legacy",phase:"render",rootParams:c,implicitTags:o,revalidate:_constants1.INFINITE_CACHE,expire:_constants1.INFINITE_CACHE,stale:_constants1.INFINITE_CACHE,tags:[...o]},R=await _workunitasyncstorageexternal.workUnitAsyncStorage.run(e,getRSCPayload,s,t,404===r.statusCode),w=x=await(0,_apprenderprerenderutils.createReactServerPrerenderResultFromRender)(_workunitasyncstorageexternal.workUnitAsyncStorage.run(e,l.renderToReadableStream,R,u.clientModules,{onError:I})),T=require("react-dom/server.edge").renderToReadableStream,M=await _workunitasyncstorageexternal.workUnitAsyncStorage.run(e,T,(0,_jsxruntime.jsx)(App,{reactServerStream:w.asUnclosingStream(),preinitScripts:y,clientReferenceManifest:u,ServerInsertedHTMLProvider:g,ServerInsertedMetadataProvider:_,nonce:t.nonce}),{onError:C,nonce:t.nonce,bootstrapScripts:[E]});if(shouldGenerateStaticFlightData(n)){const r=await(0,_nodewebstreamshelper.streamToBuffer)(w.asStream());a.flightData=r,a.segmentData=await collectSegmentData(r,e,l,d,p)}const P=(0,_makegetserverinsertedhtml.makeGetServerInsertedHTML)({polyfills:v,renderServerInsertedHTML:m,serverCapturedErrors:b,basePath:d.basePath,tracingMetadata:h});return{digestErrorsMap:f,ssrErrors:b,stream:await(0,_nodewebstreamshelper.continueFizzStream)(M,{inlinedDataStream:(0,_useflightresponse.createInlinedDataReadableStream)(w.consumeAsStream(),t.nonce,i),isStaticGeneration:!0,getServerInsertedHTML:P,getServerInsertedMetadata:S}),collectedRevalidate:e.revalidate,collectedExpire:e.expire,collectedStale:e.stale,collectedTags:e.tags}}}catch(e){if((0,_staticgenerationbailout.isStaticGenBailoutError)(e)||"object"==typeof e&&null!==e&&"message"in e&&"string"==typeof e.message&&e.message.includes("https://nextjs.org/docs/advanced-features/static-html-export"))throw e;if((0,_hooksservercontext.isDynamicServerError)(e))throw e;const g=(0,_bailouttocsr.isBailoutToCSRError)(e);if(g){const r=(0,_formatservererror.getStackWithoutErrorMessage)(e);throw(0,_log.error)(`${e.reason} should be wrapped in a suspense boundary at page "${t.pagePath}". Read more: https://nextjs.org/docs/messages/missing-suspense-with-csr-bailout\n${r}`),e}if(null===x)throw e;let _;if((0,_httpaccessfallback.isHTTPAccessFallbackError)(e))r.statusCode=(0,_httpaccessfallback.getAccessFallbackHTTPStatus)(e),_=(0,_httpaccessfallback.getAccessFallbackErrorTypeByStatus)(r.statusCode);else if((0,_redirecterror.isRedirectError)(e)){_="redirect",r.statusCode=(0,_redirect.getRedirectStatusCodeFromError)(e);P("location",(0,_addpathprefix.addPathPrefix)((0,_redirect.getURLFromRedirectError)(e),d.basePath))}else g||(r.statusCode=500);const[y,E]=(0,_requiredscripts.getRequiredScripts)(d.buildManifest,t.assetPrefix,d.crossOrigin,d.subresourceIntegrityManifest,(0,_getassetquerystring.getAssetQueryString)(t,!1),t.nonce,"/_not-found/page"),R=A={type:"prerender-legacy",phase:"render",rootParams:c,implicitTags:o,revalidate:void 0!==(null==A?void 0:A.revalidate)?A.revalidate:_constants1.INFINITE_CACHE,expire:void 0!==(null==A?void 0:A.expire)?A.expire:_constants1.INFINITE_CACHE,stale:void 0!==(null==A?void 0:A.stale)?A.stale:_constants1.INFINITE_CACHE,tags:[...(null==A?void 0:A.tags)||o]},w=await _workunitasyncstorageexternal.workUnitAsyncStorage.run(R,getErrorRSCPayload,s,t,f.has(e.digest)?void 0:e,_),T=_workunitasyncstorageexternal.workUnitAsyncStorage.run(R,l.renderToReadableStream,w,u.clientModules,{onError:I});try{const e=await(0,_nodewebstreamshelper.renderToInitialFizzStream)({ReactDOMServer:require("react-dom/server.edge"),element:(0,_jsxruntime.jsx)(AppWithoutContext,{reactServerStream:T,preinitScripts:y,clientReferenceManifest:u,nonce:t.nonce}),streamOptions:{nonce:t.nonce,bootstrapScripts:[E],formState:i}});if(shouldGenerateStaticFlightData(n)){const e=await(0,_nodewebstreamshelper.streamToBuffer)(x.asStream());a.flightData=e,a.segmentData=await collectSegmentData(e,R,l,d,p)}const r=d.dev,s=x instanceof _apprenderprerenderutils.ServerPrerenderStreamResult?x.asStream():x.consumeAsStream();return{digestErrorsMap:f,ssrErrors:b,stream:await(0,_nodewebstreamshelper.continueFizzStream)(e,{inlinedDataStream:(0,_useflightresponse.createInlinedDataReadableStream)(s,t.nonce,i),isStaticGeneration:!0,getServerInsertedHTML:(0,_makegetserverinsertedhtml.makeGetServerInsertedHTML)({polyfills:v,renderServerInsertedHTML:m,serverCapturedErrors:[],basePath:d.basePath,tracingMetadata:h}),getServerInsertedMetadata:S,validateRootLayout:r}),dynamicAccess:null,collectedRevalidate:null!==A?A.revalidate:_constants1.INFINITE_CACHE,collectedExpire:null!==A?A.expire:_constants1.INFINITE_CACHE,collectedStale:null!==A?A.stale:_constants1.INFINITE_CACHE,collectedTags:null!==A?A.tags:null}}catch(e){if("development"===process.env.NODE_ENV&&(0,_httpaccessfallback.isHTTPAccessFallbackError)(e)){const{bailOnRootNotFound:e}=require("../../client/components/dev-root-http-access-fallback-boundary");e()}throw e}}}const loadingChunks=new Set,chunkListeners=[];function trackChunkLoading(e){loadingChunks.add(e),e.finally((()=>{if(loadingChunks.has(e)&&(loadingChunks.delete(e),0===loadingChunks.size)){for(let e=0;e<chunkListeners.length;e++)chunkListeners[e]();chunkListeners.length=0}}))}async function warmFlightResponse(e,r){let t;t=process.env.TURBOPACK?require("react-server-dom-turbopack/client.edge").createFromReadableStream:require("react-server-dom-webpack/client.edge").createFromReadableStream;try{t(e,{serverConsumerManifest:{moduleLoading:r.moduleLoading,moduleMap:r.ssrModuleMapping,serverModuleMap:null}})}catch{}return trackChunkLoading((0,_scheduler.waitAtLeastOneReactRenderTask)()),new Promise((e=>{chunkListeners.push(e)}))}const getGlobalErrorStyles=async(e,r)=>{const{modules:{"global-error":t}}=(0,_parseloadertree.parseLoaderTree)(e);let a;if(t){const[,e]=await(0,_createcomponentstylesandscripts.createComponentStylesAndScripts)({ctx:r,filePath:t[1],getComponent:t[0],injectedCSS:new Set,injectedJS:new Set});a=e}return a};async function collectSegmentData(e,r,t,a,n){const s=a.clientReferenceManifest;if(!s||!a.experimental.clientSegmentCache)return;const o={moduleLoading:null,moduleMap:"edge"===process.env.NEXT_RUNTIME?s.edgeRscModuleMapping:s.rscModuleMapping,serverModuleMap:null},i=!0===a.experimental.isRoutePPREnabled&&!a.experimental.dynamicIO,c=r.stale;return await t.collectSegmentData(i,e,c,s.clientModules,o,n)}