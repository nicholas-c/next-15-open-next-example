"use strict";function _export(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}Object.defineProperty(exports,"__esModule",{value:!0}),_export(exports,{DynamicState:function(){return DynamicState},getDynamicDataPostponedState:function(){return getDynamicDataPostponedState},getDynamicHTMLPostponedState:function(){return getDynamicHTMLPostponedState},getPostponedFromState:function(){return getPostponedFromState},parsePostponedState:function(){return parsePostponedState}});const _resumedatacache=require("../resume-data-cache/resume-data-cache");var DynamicState=function(e){return e[e.DATA=1]="DATA",e[e.HTML=2]="HTML",e}({});async function getDynamicHTMLPostponedState(e,t,a){if(!t||0===t.size){const t=JSON.stringify(e);return`${t.length}:${t}${await(0,_resumedatacache.stringifyResumeDataCache)((0,_resumedatacache.createRenderResumeDataCache)(a))}`}const r=Array.from(t),n=JSON.stringify(r),c=JSON.stringify(e),o=`${n.length}${n}${c}`;return`${o.length}:${o}${await(0,_resumedatacache.stringifyResumeDataCache)(a)}`}async function getDynamicDataPostponedState(e){return`4:null${await(0,_resumedatacache.stringifyResumeDataCache)((0,_resumedatacache.createRenderResumeDataCache)(e))}`}function parsePostponedState(e,t){try{var a;const n=null==(a=e.match(/^([0-9]*):/))?void 0:a[1];if(!n)throw Object.defineProperty(new Error(`Invariant: invalid postponed state ${e}`),"__NEXT_ERROR_CODE",{value:"E314",enumerable:!1,configurable:!0});const c=parseInt(n),o=e.slice(n.length+1,n.length+c+1),s=(0,_resumedatacache.createRenderResumeDataCache)(e.slice(n.length+c+1));try{if("null"===o)return{type:1,renderResumeDataCache:s};if(/^[0-9]/.test(o)){var r;const e=null==(r=o.match(/^([0-9]*)/))?void 0:r[1];if(!e)throw Object.defineProperty(new Error(`Invariant: invalid postponed state ${JSON.stringify(o)}`),"__NEXT_ERROR_CODE",{value:"E314",enumerable:!1,configurable:!0});const a=parseInt(e),n=JSON.parse(o.slice(e.length,e.length+a));let c=o.slice(e.length+a);for(const[e,a]of n){const r=(null==t?void 0:t[e])??"",n=Array.isArray(r)?r.join("/"):r;c=c.replaceAll(a,n)}return{type:2,data:JSON.parse(c),renderResumeDataCache:s}}return{type:2,data:JSON.parse(o),renderResumeDataCache:s}}catch(e){return console.error("Failed to parse postponed state",e),{type:1,renderResumeDataCache:s}}}catch(e){return console.error("Failed to parse postponed state",e),{type:1,renderResumeDataCache:(0,_resumedatacache.createPrerenderResumeDataCache)()}}}function getPostponedFromState(e){return 1===e.type?null:e.data}