"use strict";const SINGLE_QUOTE="'".charCodeAt(0),DOUBLE_QUOTE='"'.charCodeAt(0),BACKSLASH="\\".charCodeAt(0),SLASH="/".charCodeAt(0),NEWLINE="\n".charCodeAt(0),SPACE=" ".charCodeAt(0),FEED="\f".charCodeAt(0),TAB="\t".charCodeAt(0),CR="\r".charCodeAt(0),OPEN_SQUARE="[".charCodeAt(0),CLOSE_SQUARE="]".charCodeAt(0),OPEN_PARENTHESES="(".charCodeAt(0),CLOSE_PARENTHESES=")".charCodeAt(0),OPEN_CURLY="{".charCodeAt(0),CLOSE_CURLY="}".charCodeAt(0),SEMICOLON=";".charCodeAt(0),ASTERISK="*".charCodeAt(0),COLON=":".charCodeAt(0),AT="@".charCodeAt(0),RE_AT_END=/[\t\n\f\r "#'()/;[\\\]{}]/g,RE_WORD_END=/[\t\n\f\r !"#'():;@[\\\]{}]|\/(?=\*)/g,RE_BAD_BRACKET=/.[\r\n"'(/\\]/,RE_HEX_ESCAPE=/[\da-f]/i;module.exports=function(e,E={}){let t,r,A,c,a,C,o,s,S,n,d=e.css.valueOf(),_=E.ignoreErrors,h=d.length,O=0,R=[],i=[];function N(){return O}function l(E){throw e.error("Unclosed "+E,O)}function L(){return 0===i.length&&O>=h}function f(e){if(i.length)return i.pop();if(O>=h)return;let E=!!e&&e.ignoreUnclosed;switch(t=d.charCodeAt(O),t){case NEWLINE:case SPACE:case TAB:case CR:case FEED:r=O;do{r+=1,t=d.charCodeAt(r)}while(t===SPACE||t===NEWLINE||t===TAB||t===CR||t===FEED);n=["space",d.slice(O,r)],O=r-1;break;case OPEN_SQUARE:case CLOSE_SQUARE:case OPEN_CURLY:case CLOSE_CURLY:case COLON:case SEMICOLON:case CLOSE_PARENTHESES:{let e=String.fromCharCode(t);n=[e,e,O];break}case OPEN_PARENTHESES:if(s=R.length?R.pop()[1]:"",S=d.charCodeAt(O+1),"url"===s&&S!==SINGLE_QUOTE&&S!==DOUBLE_QUOTE&&S!==SPACE&&S!==NEWLINE&&S!==TAB&&S!==FEED&&S!==CR){r=O;do{if(C=!1,r=d.indexOf(")",r+1),-1===r){if(_||E){r=O;break}l("bracket")}for(o=r;d.charCodeAt(o-1)===BACKSLASH;)o-=1,C=!C}while(C);n=["brackets",d.slice(O,r+1),O,r],O=r}else r=d.indexOf(")",O+1),c=d.slice(O,r+1),-1===r||RE_BAD_BRACKET.test(c)?n=["(","(",O]:(n=["brackets",c,O,r],O=r);break;case SINGLE_QUOTE:case DOUBLE_QUOTE:A=t===SINGLE_QUOTE?"'":'"',r=O;do{if(C=!1,r=d.indexOf(A,r+1),-1===r){if(_||E){r=O+1;break}l("string")}for(o=r;d.charCodeAt(o-1)===BACKSLASH;)o-=1,C=!C}while(C);n=["string",d.slice(O,r+1),O,r],O=r;break;case AT:RE_AT_END.lastIndex=O+1,RE_AT_END.test(d),r=0===RE_AT_END.lastIndex?d.length-1:RE_AT_END.lastIndex-2,n=["at-word",d.slice(O,r+1),O,r],O=r;break;case BACKSLASH:for(r=O,a=!0;d.charCodeAt(r+1)===BACKSLASH;)r+=1,a=!a;if(t=d.charCodeAt(r+1),a&&t!==SLASH&&t!==SPACE&&t!==NEWLINE&&t!==TAB&&t!==CR&&t!==FEED&&(r+=1,RE_HEX_ESCAPE.test(d.charAt(r)))){for(;RE_HEX_ESCAPE.test(d.charAt(r+1));)r+=1;d.charCodeAt(r+1)===SPACE&&(r+=1)}n=["word",d.slice(O,r+1),O,r],O=r;break;default:t===SLASH&&d.charCodeAt(O+1)===ASTERISK?(r=d.indexOf("*/",O+2)+1,0===r&&(_||E?r=d.length:l("comment")),n=["comment",d.slice(O,r+1),O,r],O=r):(RE_WORD_END.lastIndex=O+1,RE_WORD_END.test(d),r=0===RE_WORD_END.lastIndex?d.length-1:RE_WORD_END.lastIndex-2,n=["word",d.slice(O,r+1),O,r],R.push(n),O=r)}return O++,n}function T(e){i.push(e)}return{back:T,endOfFile:L,nextToken:f,position:N}};