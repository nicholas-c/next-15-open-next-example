"use strict";const{parseContentType:parseContentType}=require("./utils.js");function getInstance(e){const t=e.headers,r=parseContentType(t["content-type"]);if(!r)throw new Error("Malformed content type");for(const n of TYPES){if(!n.detect(r))continue;const o={limits:e.limits,headers:t,conType:r,highWaterMark:void 0,fileHwm:void 0,defCharset:void 0,defParamCharset:void 0,preservePath:!1};return e.highWaterMark&&(o.highWaterMark=e.highWaterMark),e.fileHwm&&(o.fileHwm=e.fileHwm),o.defCharset=e.defCharset,o.defParamCharset=e.defParamCharset,o.preservePath=e.preservePath,new n(o)}throw new Error(`Unsupported content type: ${t["content-type"]}`)}const TYPES=[require("./types/multipart"),require("./types/urlencoded")].filter((function(e){return"function"==typeof e.detect}));module.exports=e=>{if("object"==typeof e&&null!==e||(e={}),"object"!=typeof e.headers||null===e.headers||"string"!=typeof e.headers["content-type"])throw new Error("Missing Content-Type");return getInstance(e)};